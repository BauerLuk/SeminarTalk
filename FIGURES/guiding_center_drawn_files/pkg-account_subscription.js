define("modules/clean/account_page/tabs/plan",["require","exports","tslib","react","modules/clean/account_page/widgets/plan/views/plan_container"],(function(e,t,a,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return n.default.createElement(s.PlanContainer,{browserUpdateRequired:this.props.browserUpdateRequired,trialsConfig:this.props.trialsConfig,firstName:this.props.firstName,expRetentionAccountWayfinding:this.props.expRetentionAccountWayfinding,expRetentionAccountChanges:this.props.expRetentionAccountChanges,expRetentionAccountChangesBasic:this.props.expRetentionAccountChangesBasic,expRetentionPersonalScheduledCancellation:this.props.expRetentionPersonalScheduledCancellation,isPasswordsEnabled:this.props.isPasswordsEnabled,isVaultEnabled:this.props.isVaultEnabled})},t})((n=a.__importDefault(n)).default.Component);t.PlanTab=o})),define("modules/clean/account_page/widgets/plan/referral_history/action_creators",["require","exports","tslib","modules/clean/account_page/util","modules/clean/account_page/widgets/plan/referral_history/api","external/lodash"],(function(e,t,a,n,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=a.__importStar(o),t.loadReferralHistoryIfNecessary=function(){var e=this;return function(t,r){return a.__awaiter(e,void 0,void 0,(function(){var e,l,i;return a.__generator(this,(function(a){switch(a.label){case 0:return"loading"!==(e=r().planTab).referralLoadingState&&e.referralHistory.has_more?(t({type:"load_referral_history"}),l=e.referralHistory.page+1,[4,s.getReferralHistory(n.getCurrentUser().id,l)]):[3,2];case 1:return(i=a.sent()).rows.forEach((function(e){e.id=o.uniqueId("referral_row_")})),t({type:"referral_history_loaded",history:i}),[2,!0];case 2:return[2,!1]}}))}))}}})),define("modules/clean/account_page/widgets/plan/referral_history/api",["require","exports","tslib","modules/clean/ajax_as_promised"],(function(e,t,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getReferralHistory=function(e,t){return a.__awaiter(this,void 0,Promise,(function(){return a.__generator(this,(function(a){return[2,n.WebRequest({url:"/account/bonus_page/"+t,subject_user:e,dataType:"json"})]}))}))}})),define("modules/clean/account_page/widgets/plan/views/add_ons",["require","exports","tslib","modules/core/i18n","modules/clean/react/css","react","modules/clean/static_urls","modules/clean/payments/skus/constants","modules/clean/account_page/widgets/plan/views/cancel_subs_warning_modal","modules/clean/account_page/widgets/plan/views/evh_modal","modules/clean/analytics"],(function(e,t,a,n,s,o,r,l,i,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.openEvhModal=function(e){var n=t.props.scheduledForDowngrade;e.stopPropagation(),n?i.CancelChangesModalConfirmation.showInstance({transitionPerformed:t.props.transitionPerformed,subStatus:t.props.subStatus}):c.EvhModalView.showInstance(a.__assign({},t.props))},t}return a.__extends(t,e),Object.defineProperty(t.prototype,"evhTitle",{get:function(){return this.props.evhInfo.is_unlimited_evh?n.intl.formatMessage({id:"e3QD4M",defaultMessage:"Unlimited version history"}):n.intl.formatMessage({id:"W7X9jY",defaultMessage:"Extended version history"})},enumerable:!0,configurable:!0}),t.prototype.isLoading=function(){return"ready"!==this.props.evhLoadingState},t.prototype.evhLink=function(){var e=this.props.evhInfo,t=e.purchased,a=e.scheduled_to_remove,s=e.is_free_evh;if(!a&&!s){var r=t?n.intl.formatMessage({id:"wcAlBh",defaultMessage:"Remove EVH"}):n.intl.formatMessage({id:"Qy2Jzq",defaultMessage:"Add EVH"});return t?u.ProEventsLogger.log("de_plan_tab_evh_remove_link_click"):u.ProEventsLogger.log("de_plan_tab_evh_add_link_click"),o.default.createElement("a",{className:"evh-link",href:"#",onClick:this.openEvhModal},r)}},t.prototype.showExtendedVersionHistory=function(){var e=this.props,t=e.subStatus,a=e.evhInfo;if(t.subState.billingSchedule){var s=n.intl.formatMessage({id:"QljYPN",defaultMessage:"One year file version history for {evh_price} per {billing_period}"},{evh_price:a.evh_price,billing_period:t.subState.billingSchedule.scheduleDescriptionNoun});if(t.subState.addons.peekSkus())switch(t.subState.addons.sku.adminCxId){case l.AdminCxId.UNLIMITED_FREE_VERSION_HISTORY:s=n.intl.formatMessage({id:"d+WMjv",defaultMessage:"Free unlimited file version history"});break;case l.AdminCxId.UNLIMITED_MONTHLY_VERSION_HISTORY:case l.AdminCxId.UNLIMITED_YEARLY_VERSION_HISTORY:case l.AdminCxId.UNLIMITED_PAID_VERSION_HISTORY:s=n.intl.formatMessage({id:"dgVLQh",defaultMessage:"Unlimited file version history for {evh_price} per {billing_period}"},{evh_price:a.evh_price,billing_period:t.subState.billingSchedule.scheduleDescriptionNoun});break;case l.AdminCxId.ONE_YEAR_PAID_VERSION_HISTORY:s=n.intl.formatMessage({id:"QljYPN",defaultMessage:"One year file version history for {evh_price} per {billing_period}"},{evh_price:a.evh_price,billing_period:t.subState.billingSchedule.scheduleDescriptionNoun});break;case l.AdminCxId.ONE_YEAR_FREE_VERSION_HISTORY:s=n.intl.formatMessage({id:"VK+2VG",defaultMessage:"Free one year file version history"});break;case l.AdminCxId.FREE_120_DAYS_VERSION_HISTORY:s=n.intl.formatMessage({id:"QOTha4",defaultMessage:"Free 120 days file version history"});break;default:throw new Error("Unknown extended version history add-on")}return o.default.createElement("div",{className:"evh-container"},o.default.createElement("div",{className:"evh-body"},o.default.createElement("div",{className:"evh-text"},o.default.createElement("p",{className:"evh-title"},this.evhTitle),o.default.createElement("p",{className:"evh-content"},s)),this.evhLink()))}},t.prototype.render=function(){return this.props.evhInfo.is_available?this.isLoading()?o.default.createElement("div",{className:"loading-indicator"},o.default.createElement("img",{src:r.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:n.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})})):o.default.createElement("div",{className:"add-ons"},o.default.createElement("p",{className:"header"},n.intl.formatMessage({id:"lfz3xn",defaultMessage:"Available add-ons"})),o.default.createElement("p",{className:"context"},n.intl.formatMessage({id:"0bfcmS",defaultMessage:"Extend the functionality of your Dropbox plan with add-ons"})),this.showExtendedVersionHistory()):o.default.createElement("noscript",null)},t})((o=a.__importDefault(o)).default.Component);t.AddOns=s.requireCssWithComponent(d,["/static/css/account/pagelet/add_ons-vfllNms60.css"])})),define("modules/clean/account_page/widgets/plan/views/cancel_basic_downgrade",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/css","modules/clean/account_page/widgets/plan/views/cancel_changes_modal","modules/clean/account_page/constants","dig-components/buttons","modules/clean/analytics","modules/clean/react/growth/scheduled_cancellation_snackbar"],(function(e,t,a,n,s,o,r,l,i,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),t.CancelBasicDowngrade=function(e){var t=e.planEndDate,a=e.transitionPerformed,o=e.billingScheduleId,d=s.intl.formatMessage({id:"qZB3PX",defaultMessage:"Your paid plan will end on <b>{planEndDate}</b>."},{planEndDate:t,b:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.default.createElement("b",null,e)}}),p=s.intl.formatMessage({id:"CtOAJT",defaultMessage:"Undo plan change"});return c.ProEventsLogger.log("scheduled_cancellation_on_plans_did_mount",{planEndDate:t,billingScheduleId:o}),n.default.createElement("div",{className:"cancel-basic-downgrade"},n.default.createElement("span",null,d),n.default.createElement("span",null," "),n.default.createElement(i.Button,{onClick:function(){c.ProEventsLogger.log("scheduled_cancellation_on_plans_undo_plans_change_clicked",{planEndDate:t,billingScheduleId:o});r.CancelChangesModalConfirmationView.showInstance({cancellationType:l.CancellationType.IND_SUBSCRIPTION,shouldShowRedesignedModal:!0,transitionPerformed:function(){u.setCancellationReminderDismissalInfo(0,0),a()},reOpenModalDialogAfterCancellation:!1})},variant:"transparent"},p))},t.CancelBasicDowngradeWithCss=o.requireCssWithComponent(t.CancelBasicDowngrade,["/static/css/account/pagelet/cancel_basic_downgrade-vflI1i1s-.css"])})),define("modules/clean/account_page/widgets/plan/views/upsell_module",["require","exports","tslib","react","spectrum/button","modules/clean/react/css"],(function(e,t,a,n,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.headline,a=e.text,o=e.cta;return n.default.createElement("section",{className:"upsell-module"},n.default.createElement("div",{className:"upsell-module__content-container"},n.default.createElement("div",{className:"upsell-module__text-wrapper"},n.default.createElement("h2",{className:"upsell-module__headline"},t),n.default.createElement("p",{className:"upsell-module__body"},a)),n.default.createElement(s.Button,{className:"upsell-module__button",href:o.link},o.text)))},t})((n=a.__importDefault(n)).default.Component);t.UpsellModule=o.requireCssWithComponent(r,["/static/css/account/pagelet/upsell_module-vfl5PvHgu.css"])})),define("modules/clean/account_page/widgets/plan/views/churn_survey/biz_churn_survey",["require","exports","tslib","react","modules/clean/analytics","spectrum/modal","modules/clean/react/css","modules/clean/account_page/widgets/plan/views/churn_survey/churn_survey_wrapper"],(function(e,t,a,n,s,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(t){var a=e.call(this,t)||this;return a.handleClose=function(){s.TeamsWebActionsLogger.log("team_cancel_reason_abandon"),a.setState({isOpen:!1})},a.handleSkipSurvey=function(){s.TeamsWebActionsLogger.log("team_cancel_reason_skip"),a.props.postSubmitHandler()},a.handleSubmitSurvey=function(){void 0!==a.state.selectedReasonVal&&(s.TeamsWebActionsLogger.log("team_cancel_reason_submit",{cancel_reason:a.state.selectedReasonVal,other_response:a.state.otherResponse}),a.props.postSubmitHandler())},a.handleSelectReason=function(e){a.setState({selectedReasonVal:e,otherResponse:""})},a.onOtherInputChange=function(e){a.setState({otherResponse:e.currentTarget.value})},a.state={otherResponse:"",isOpen:!0},a}return a.__extends(t,e),t.prototype.componentDidMount=function(){s.TeamsWebActionsLogger.log("team_cancel_reason_modal_open")},t.prototype.render=function(){return n.createElement(o.Modal,{ariaLabel:"BizChurnSurveyModal",open:this.state.isOpen,displayCloseButton:!0,overlayClickClose:!1,onRequestClose:this.handleClose,width:642},n.createElement(l.ChurnSurvey,{reasons:this.props.reasons,selectedReasonVal:this.state.selectedReasonVal,handleSelectReason:this.handleSelectReason,onOtherInputChange:this.onOtherInputChange,handleSkipSurvey:this.handleSkipSurvey,handleSubmitSurvey:this.handleSubmitSurvey,isBiz:!0}))},t})((n=a.__importStar(n)).Component);t.BizChurnSurveyModalView=i,t.BizChurnSurveyModal=r.requireCssWithComponent(i,["/static/css/spectrum/index.web-vflTq87Ea.css","/static/css/account/pagelet/biz_churn_survey-vfl7hogrG.css"])})),define("modules/clean/account_page/widgets/plan/views/churn_survey/biz_churn_survey_consts",["require","exports","modules/core/i18n","modules/constants/trademark","modules/clean/payments/skus/constants"],(function(e,t,a,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ORIGINAL_SURVEY_REASONS=[{reason:a.intl.formatMessage({id:"R7g2cG",defaultMessage:"Our business needed {trademark_business} temporarily"},{trademark_business:n.TRADEMARK_BUSINESS}),value:"temporary-need"},{reason:a.intl.formatMessage({id:"1lJuQj",defaultMessage:"Our business couldn’t justify the pricing of {trademark_business}"},{trademark_business:n.TRADEMARK_BUSINESS}),value:"differentiated-pricing"},{tip:{title:a.intl.formatMessage({id:"Zzhtmv",defaultMessage:"Want to reduce your bill?"}),body:a.intl.formatMessage({id:"kGrR3C",defaultMessage:"You can decrease cost by removing licenses your team isn’t currently using."}),cta:{link:"/team/admin/billing/manage?show_manage_licenses",text:a.intl.formatMessage({id:"wspJjc",defaultMessage:"Manage licenses here."})}},reason:a.intl.formatMessage({id:"eWQ8qY",defaultMessage:"Our business didn’t need all the licenses we had"}),value:"license-mismatch"},{reason:a.intl.formatMessage({id:"rgIel5",defaultMessage:"Our business needed features {trademark_business} doesn’t have"},{trademark_business:n.TRADEMARK_BUSINESS}),value:"features-missing"},{reason:a.intl.formatMessage({id:"hBBZPJ",defaultMessage:"Our business wasn’t satisfied with the way features worked"}),value:"product-expectations"},{reason:a.intl.formatMessage({id:"9jay6Z",defaultMessage:"Our business is changing to {trademark_plus} or {trademark_professional}"},{trademark_plus:n.TRADEMARK_PLUS,trademark_professional:n.TRADEMARK_PROFESSIONAL}),value:"downgrading"}],t.SURVEY_REASONS=[{reason:a.intl.formatMessage({id:"foRa9q",defaultMessage:"Temporary need"}),value:"temporary-need"},{reason:a.intl.formatMessage({id:"+el3Kt",defaultMessage:"Too expensive"}),value:"differentiated-pricing"},{reason:a.intl.formatMessage({id:"7i/n0m",defaultMessage:"Need more or fewer spots for my team"}),value:"license-mismatch"},{reason:a.intl.formatMessage({id:"xmoiwu",defaultMessage:"Need features Dropbox doesn’t have"}),value:"features-missing"},{reason:a.intl.formatMessage({id:"LXF59w",defaultMessage:"Not satisfied"}),value:"product-expectations"},{reason:a.intl.formatMessage({id:"RUluvD",defaultMessage:"Switching to Dropbox {trademark_professional} or {trademark_plus}"},{trademark_professional:n.TRADEMARK_PROFESSIONAL,trademark_plus:n.TRADEMARK_PLUS}),value:"downgrading"}],t.DUMMY_SUB_STATUS={subState:{plan:{productType:s.ProductPlanType.ADVANCED,displayName:function(){return n.TRADEMARK_BUSINESS}}}},t.TEST_ENTRYPOINT_COMBOS=[{expRetentionBizChurnSurvey:"CONTROL",expRetentionBizChurnSurveyTrials:"OFF",expectedToBeCalled:"logExposureIfOn"},{expRetentionBizChurnSurvey:"OFF",expRetentionBizChurnSurveyTrials:"CONTROL",expectedToBeCalled:"logExposureIfOn"},{expRetentionBizChurnSurvey:"V1",expRetentionBizChurnSurveyTrials:"OFF",expectedToBeCalled:"showOriginalBizChurnSurvey"},{expRetentionBizChurnSurvey:"OFF",expRetentionBizChurnSurveyTrials:"V1",expectedToBeCalled:"showOriginalBizChurnSurvey"},{expRetentionBizChurnSurvey:"V2",expRetentionBizChurnSurveyTrials:"OFF",expectedToBeCalled:"showBizChurnSurvey"},{expRetentionBizChurnSurvey:"OFF",expRetentionBizChurnSurveyTrials:"V2",expectedToBeCalled:"showBizChurnSurvey"}]})),define("modules/clean/account_page/widgets/plan/views/churn_survey/biz_churn_survey_util",["require","exports","tslib","external/lodash","react-modal","modules/clean/react/modal","react","modules/clean/stormcrow/stormcrow_exposure_logger","modules/clean/react/teams/offboarding/cancel_reason/cancel_reason_survey_modal","modules/clean/account_page/widgets/plan/views/churn_survey/biz_churn_survey_consts","modules/clean/account_page/widgets/plan/views/churn_survey/biz_churn_survey"],(function(e,t,a,n,s,o,r,l,i,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importStar(n),s=a.__importDefault(s),r=a.__importStar(r);var d,p,m=!1;t.logExposureIfOn=function(e,t){l.logVariantExposure("retention_biz_churn_survey",e),l.logVariantExposure("retention_biz_churn_survey_trials",t)},t.showOriginalBizChurnSurvey=function(e,t){void 0===d&&(d=n.shuffle(c.ORIGINAL_SURVEY_REASONS));var a={firstName:e,reasons:d,experiments:{expSubgrowthBizCancelBudgetDownsellRwls:"OFF"},expRenewBizRevampTeamCancel:!1,subStatus:c.DUMMY_SUB_STATUS,isEligibleForCancellationRefund:!1,csrfToken:"",postSubmitHandler:t};i.ShowCancelReasonSurveyModalView.showInstance(a)},t.showBizChurnSurvey=function(e){void 0===p&&(p=n.shuffle(c.SURVEY_REASONS)),m||(m=!0,s.default.setAppElement(document.body)),o.Modal.showInstance(r.createElement(u.BizChurnSurveyModal,{reasons:p,postSubmitHandler:e}))}})),define("modules/clean/account_page/widgets/plan/views/evh_modal",["require","exports","tslib","modules/core/notify","react","modules/clean/ajax","modules/core/browser","modules/clean/react/css","classnames","modules/core/i18n","modules/clean/payments/skus/constants","modules/clean/react/payments/update_individual_billing/update_individual_store_creator","modules/clean/account_page/widgets/plan/views/cancellable_notifications_view","modules/clean/account_page/constants","modules/clean/account_page/widgets/plan/views/cancel_changes_modal","modules/clean/payments/cash","spectrum/checkbox","modules/clean/account_page/widgets/plan/views/individual_inline_payment_method","modules/clean/react/payments/update_individual_billing/update_individual_billing_modal_loader","modules/clean/dbmodal_stack","modules/clean/account_page/widgets/plan/views/evh_removal_warning","modules/clean/react/modal","modules/clean/account_page/widgets/plan/types","modules/clean/analytics","modules/clean/payments/skus/subscription_service","modules/clean/payments/skus/subscription_change_plan","modules/clean/account_page/util","modules/clean/account_page/widgets/plan/views/update_billing_info_link"],(function(e,t,a,n,s,o,r,l,i,c,u,d,p,m,f,h,g,_,v,b,y,S,w,M,C,E,R,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=a.__importDefault(s),o=a.__importStar(o),r=a.__importStar(r),i=a.__importDefault(i);var x=(function(e){function t(t){var a=e.call(this,t)||this;return a.onAccept=function(){var e=a.props.evhInfo.purchased?w.PerformPlanTransition.REMOVE_EVH:w.PerformPlanTransition.ADD_EVH;a.setState((function(e){return e.submitting=!0,e})),o.WebRequest({url:"/account/perform_personal_transition",data:{transition_change_type:e},subject_user:R.getCurrentUser().id,success:function(e){var t=JSON.parse(e);if(t.redirect)return r.redirect(t.redirect);n.Notify.success(c.intl.formatMessage({id:"S5q7Tt",defaultMessage:"You’ve changed your plan!"})),M.ProEventsLogger.log("de_evh_modal_toggle_evh"),a.props.transitionPerformed&&a.props.transitionPerformed(),S.Modal.close()},error:function(){n.Notify.error(c.intl.formatMessage({id:"K7gpe8",defaultMessage:"There was an error updating your plan!"})),a.setState((function(e){return e.submitting=!1,e}))}})},a.toggleEvh=function(){var e=a.props.evhInfo,t=a.state.isEvhSelected;e.scheduled_to_remove||(M.ProEventsLogger.log("de_evh_modal_change_evh_election",{from:t?"evh_on":"evh_off",to:t?"evh_off":"evh_on"}),a.setState({isEvhSelected:!t}))},a.cancelEvhChange=function(){return a.handleCancelActions(m.CancellationType.EVH_ADDON),!1},a.handleCancelActions=function(e){return a.props.subStatus&&f.CancelChangesModalConfirmationView.showInstance({transitionPerformed:a.props.transitionPerformed,cancellationType:e,reOpenModalDialogAfterCancellation:!0}),!1},a.transitionPerformedClosure=function(){if(a.props.transitionPerformed)return a.props.transitionPerformed()},a.updateBillingInfo=function(e){S.Modal.close(),b.DBModalStack.register(d.BILLING_INFO_UPDATED,(function(){a.props.transitionPerformed&&a.props.transitionPerformed()})),v.IndividualUpdateBillingModalLoader.showInstance()},a.onAcceptEvhRemovalWarning=function(){y.EvhRemovalWarningModal.showInstance({evhInfo:a.props.evhInfo,transitionPerformed:a.props.transitionPerformed,subStatus:a.props.subStatus})},new C.SubscriptionService,a.state={isEvhSelected:t.evhInfo.purchased,submitting:!1},a}return a.__extends(t,e),t.showInstance=function(e){S.Modal.showInstance(s.default.createElement(t.EvhModalViewModal,a.__assign({},e)))},t.prototype.isProfessionalPlanScheduled=function(){var e=this.props.subStatus;return!!(e&&e.scheduledSubState&&e.scheduledSubState.plan)&&(e.scheduledSubState.plan.productType===u.ProductPlanType.PROFESSIONAL||e.scheduledSubState.plan.productType===u.ProductPlanType.PROFESSIONAL_TRIAL)},t.prototype.isPlanScheduledToChange=function(){var e=this.props.subStatus;return!!(e&&e.subState.plan&&e.finalSubState.plan)&&e.subState.plan.productType!==e.finalSubState.plan.productType},t.prototype.isScheduledToChange=function(){return this.isPlanScheduledToChange()||this.isBillingScheduleToChange()||this.isEvhScheduledToChange()},t.prototype.isEvhScheduledToChange=function(){var e=this.props.subStatus;return!(!e||!e.scheduledSubState)&&e.subState.quantityForEvhAddOn()!==e.scheduledSubState.quantityForEvhAddOn()},t.prototype.isBillingScheduleToChange=function(){var e=this.props.subStatus;return!!(e&&e.subState.billingSchedule&&e.finalSubState.billingSchedule)&&e.subState.billingSchedule.id!==e.finalSubState.billingSchedule.id},t.prototype.renderFooter=function(){var e=this.props,t=e.evhInfo,a=e.subStatus,n=this.state.isEvhSelected;if(t.scheduled_to_remove)return s.default.createElement("p",{className:"evh-modal-footer"},c.intl.formatMessage({id:"7djceN",defaultMessage:"You’ve already requested a plan change. If you want to choose a different plan, first cancel your pending change."})," ",s.default.createElement("a",{onClick:this.cancelEvhChange},c.intl.formatMessage({id:"7kgsyk",defaultMessage:"Cancel change"})));if(t.evh_transition&&a.subState&&a.subState.plan&&a.scheduledSubState&&a.scheduledSubState.plan){var o=E.SubscriptionChangePlan.deserialize(t.evh_transition);if(n){if(t.purchased)return this.isScheduledToChange()&&a.scheduledSubState&&a.scheduledSubState.plan?s.default.createElement("p",{className:"evh-modal-footer"},c.intl.formatMessage({id:"Wko3oQ",defaultMessage:"Starting on {date}, we’ll bill you once a {schedule_noun} for your Dropbox {plan_name} plan and your new {schedule} total will be {scheduled_total}."},{plan_name:a.scheduledSubState.plan.displayName(),date:a.subState.formattedNextBillingDate,schedule:a.scheduledSubState.billingSchedule.scheduleDescriptionAdjective,schedule_noun:a.scheduledSubState.billingSchedule.scheduleDescriptionNoun,scheduled_total:h.Cash.formatWithTaxLabels(a.nextBillingSummary.total,a.nextBillingSummary),strong:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.default.createElement("strong",null,e)}})):s.default.createElement("p",{className:"evh-modal-footer"},c.intl.formatMessage({id:"1aBDFR",defaultMessage:"Your Dropbox {plan_name} + extended version history plan will renew on {date}. Your current {billing_schedule} total is {total}."},{plan_name:a.subState.plan.displayName(),date:a.subState.formattedNextBillingDate,billing_schedule:a.subState.billingSchedule.scheduleDescriptionAdjective,total:a.currentBillingSummary?h.Cash.formatWithTaxLabels(a.currentBillingSummary.total,a.currentBillingSummary):""}));var r="";return o.tvm&&(r=h.Cash.formatWithTaxLabels(o.tvm.getTotalPrice(),o.nextBillingSummary)),s.default.createElement("div",{className:"evh-modal-footer"},s.default.createElement("span",{className:"change-summary"},c.intl.formatMessage({id:"bEFfDy",defaultMessage:"Change summary"})),s.default.createElement("p",null,c.intl.formatMessage({id:"w15oQs",defaultMessage:"You’re adding extended version history to your Dropbox {plan_name} plan. <strong>We’ll charge you {prorated_price} now</strong>, which has been prorated for the current billing period. Your plan will renew on {date}. Your new {billing_schedule} total will be {recurring_total}."},{plan_name:a.scheduledSubState.plan.displayName(),prorated_price:r,date:a.subState.formattedNextBillingDate,billing_schedule:o.subState.billingSchedule.scheduleDescriptionAdjective,recurring_total:h.Cash.formatWithTaxLabels(o.nextBillingSummary.total,o.nextBillingSummary),strong:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.default.createElement("strong",null,e)}})))}return t.purchased&&o.scheduledSubState?s.default.createElement("div",{className:"evh-modal-footer"},s.default.createElement("span",{className:"change-summary"},c.intl.formatMessage({id:"bEFfDy",defaultMessage:"Change summary"})),s.default.createElement("p",null,c.intl.formatMessage({id:"Dw43cf",defaultMessage:"Starting on {date}, your plan will be downgraded to Dropbox {plan_name} <strong>without</strong> extended version history. You will revert to {days} day version history. Your new {billing_schedule} total will be {scheduled_total}."},{date:a.subState.formattedNextBillingDate,plan_name:a.scheduledSubState.plan.displayName(),days:this.isProfessionalPlanScheduled()?"120":"30",billing_schedule:o.scheduledSubState.billingSchedule.scheduleDescriptionAdjective,scheduled_total:h.Cash.formatWithTaxLabels(o.nextBillingSummary.total,o.nextBillingSummary),strong:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.default.createElement("strong",null,e)}}))):s.default.createElement("p",{className:"evh-modal-footer"},c.intl.formatMessage({id:"dSUqxL",defaultMessage:"Your Dropbox {plan_name} plan will renew on {date}."},{plan_name:a.subState.plan.displayName(),date:a.subState.formattedNextBillingDate})," ",c.intl.formatMessage({id:"kGTK+0",defaultMessage:"Your current {billing_schedule} total is {total}."},{billing_schedule:a.subState.billingSchedule.scheduleDescriptionAdjective,total:a.currentBillingSummary?h.Cash.formatWithTaxLabels(a.currentBillingSummary.total,a.currentBillingSummary):""}))}},t.prototype.getModalContent=function(){var e=this.props,t=e.evhInfo,a=e.subStatus,n=e.paymentInfo,o=this.state.isEvhSelected,r=c.intl.formatMessage({id:"T/CxU4",defaultMessage:"year"});a.subState.billingSchedule&&(r=a.subState.billingSchedule.scheduleDescriptionNoun);var l=i.default({"evh-modal-toggle-box-price-box__price":!0,"evh-modal-toggle-box-price-box__price--disabled":t.scheduled_to_remove}),d=c.intl.formatMessage({id:"EOwMfn",defaultMessage:"See all deletion and version history of your files for one year."});return a.subState.addons.peekSkus()&&a.subState.addons.sku.adminCxId===u.AdminCxId.UNLIMITED_PAID_VERSION_HISTORY&&(d=c.intl.formatMessage({id:"8o9wUX",defaultMessage:"See all deletion and version history of your files for unlimited time."})),s.default.createElement("div",null,s.default.createElement(p.CancellableNotificationsView,{subStatus:a,transitionPerformed:this.transitionPerformedClosure,displaySingleChangeCancellationItem:m.CancellationType.ALL,reOpenModalDialogAfterCancellation:!0,paymentInfo:n,displayNewTotal:!1}),s.default.createElement("div",{className:"evh-modal-toggle-box"},s.default.createElement("div",{className:"evh-modal-toggle-box__toggle-btn"},s.default.createElement(g.Checkbox,{checked:o?"checked":"unchecked",onChange:this.toggleEvh,disabled:t.scheduled_to_remove})),s.default.createElement("div",{className:"evh-modal-toggle-box__desc"},s.default.createElement("label",{onClick:this.toggleEvh},s.default.createElement("p",{className:"evh-modal-toggle-box__desc-title"},c.intl.formatMessage({id:"W7X9jY",defaultMessage:"Extended version history"}))),s.default.createElement("p",{className:"evh-modal-toggle-box__desc-description"},d),s.default.createElement("a",{className:"evh-modal-toggle-box__desc-link",href:"/help/security/extended-version-history",target:"_blank",rel:"noopener noreferrer"},c.intl.formatMessage({id:"IS3gY2",defaultMessage:"See EVH details"}))),s.default.createElement("div",{className:"evh-modal-toggle-box-price-box"},s.default.createElement("p",{className:l},t.evh_price),s.default.createElement("span",{className:"evh-modal-toggle-box-price-box__price-desc"},c.intl.formatMessage({id:"4KdOkL",defaultMessage:"per {schedule_noun}"},{schedule_noun:r})))),this.renderFooter(),this.renderPaymentMethod())},t.prototype.renderPaymentMethod=function(){var e=this.props.paymentMethod;if(!this.acceptButtonDisabled&&e)return s.default.createElement("div",{className:"upgrade-payment-method-link"},s.default.createElement(_.IndividualInlinePaymentMethodView,{paymentMethod:e,renderUpdateLink:s.default.createElement(T.UpdateBillingInfo,{updateBillingCTA:this.updateBillingInfo})}))},Object.defineProperty(t.prototype,"acceptButtonDisabled",{get:function(){var e=this.props.evhInfo;return this.state.isEvhSelected===e.purchased||e.scheduled_to_remove},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this.props,t=e.subStatus,a=e.transitionPerformed,n=this.state,o=n.submitting,r=n.isEvhSelected;t&&a&&b.DBModalStack.clear();var l=this.onAccept;return r||(l=this.onAcceptEvhRemovalWarning),s.default.createElement(S.Modal,{autoClose:!1,acceptButtonDisabled:this.acceptButtonDisabled,acceptButtonText:c.intl.formatMessage({id:"H59ICk",defaultMessage:"Save change"}),dismissButtonText:c.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),onAccept:l,submitting:o,className:"evh-modal",title:c.intl.formatMessage({id:"nsIJp1",defaultMessage:"Edit EVH add-on"})},this.getModalContent())},t.EvhModalViewModal=l.requireCssWithComponent(t,["/static/css/account/pagelet/evh_modal-vflx1PCV_.css"]),t})(s.default.Component);t.EvhModalView=x})),define("modules/clean/account_page/widgets/plan/views/evh_removal_warning",["require","exports","tslib","modules/clean/ajax","modules/core/browser","modules/clean/react/css","modules/core/notify","react","modules/core/i18n","modules/clean/account_page/util","modules/clean/account_page/widgets/plan/types","modules/clean/react/modal","modules/clean/analytics","modules/clean/payments/skus/constants"],(function(e,t,a,n,s,o,r,l,i,c,u,d,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importStar(n),s=a.__importStar(s);var f=(function(e){function t(t){var a=e.call(this,t)||this;return a.onAccept=function(){var e=a.props.evhInfo.purchased?u.PerformPlanTransition.REMOVE_EVH:u.PerformPlanTransition.ADD_EVH;a.setState((function(e){return e.submitting=!0,e})),n.WebRequest({url:"/account/perform_personal_transition",data:{transition_change_type:e},subject_user:c.getCurrentUser().id,success:function(e){var t=JSON.parse(e);if(t.redirect)return s.redirect(t.redirect);r.Notify.success(i.intl.formatMessage({id:"S5q7Tt",defaultMessage:"You’ve changed your plan!"})),p.ProEventsLogger.log("de_evh_modal_toggle_evh"),a.props.transitionPerformed&&a.props.transitionPerformed(),d.Modal.close()},error:function(){r.Notify.error(i.intl.formatMessage({id:"K7gpe8",defaultMessage:"There was an error updating your plan!"})),a.setState((function(e){return e.submitting=!1,e}))}})},a.state={submitting:!1},a}return a.__extends(t,e),t.showInstance=function(e){d.Modal.showInstance(l.default.createElement(t.EvhRemovalWarningModalView,a.__assign({},e)))},t.prototype.render=function(){var e=this.props.subStatus,t=this.state.submitting;if(!e||!e.subState.plan)return l.default.createElement("noscript",null);var a=e.subState.plan.productType===m.ProductPlanType.PROFESSIONAL?"120":"30";return l.default.createElement(d.Modal,{title:i.intl.formatMessage({id:"Q+i9bs",defaultMessage:"Removing EVH is permanent"}),acceptButtonDisabled:this.state.submitting,autoClose:!1,acceptButtonText:i.intl.formatMessage({id:"m4P3CO",defaultMessage:"Confirm removal"}),dismissButtonText:i.intl.formatMessage({id:"7kgsyk",defaultMessage:"Cancel change"}),onAccept:this.onAccept,className:"evh-removal-warning-modal",submitting:t},l.default.createElement("div",null,l.default.createElement("p",{className:"evh-removal-warning-modal__desc"},i.intl.formatMessage({id:"qdhfl4",defaultMessage:"Are you sure you want to remove extended version history? Once you remove it, you won’t be able to add it back again. Your plan will change from one year of version history to the Dropbox {plan} length of {days} days of version history."},{plan:e.subState.plan.displayName(!1,!0),days:a}))))},t.EvhRemovalWarningModalView=o.requireCssWithComponent(t,["/static/css/account/pagelet/evh_removal_warning-vfloW5p1U.css"]),t})((l=a.__importDefault(l)).default.Component);t.EvhRemovalWarningModal=f})),define("modules/clean/account_page/widgets/plan/views/plan_container",["require","exports","tslib","modules/clean/react/payments/update_individual_billing/update_individual_store_creator","react","react-redux","modules/clean/react/css","modules/clean/web_timing_logger","modules/clean/account_page/util","modules/clean/account_page/widgets/billing/payment_methods_util","modules/clean/account_page/widgets/plan/views/add_ons","modules/clean/account_page/widgets/plan/views/individual_cancel_survey/individual_cancel_survey_modal","modules/clean/account_page/widgets/plan/views/montana/common","modules/clean/account_page/widgets/plan/views/upsell_module","modules/clean/account_page/widgets/plan/views/cancel_plan","modules/clean/account_page/widgets/plan/views/billing_summary","modules/clean/account_page/constants","modules/clean/dbmodal_stack","modules/clean/account_page/widgets/plan/action_creators","modules/clean/account_page/widgets/billing/action_creators","modules/clean/account_page/widgets/plan/add_ons/action_creators","modules/clean/account_page/widgets/plan/referral_history/action_creators","modules/clean/account_page/widgets/plan/views/plan_status","modules/clean/payments/skus/constants","modules/constants/trademark","modules/clean/account_page/widgets/plan/views/change_plan_modal","modules/clean/account_page/widgets/plan/views/quota_usage","modules/clean/account_page/components/loading","modules/clean/account_page/components/button_block","modules/clean/account_page/widgets/plan/views/referral_space","modules/clean/account_page/widgets/plan/views/cancellable_notifications_view","modules/clean/analytics","modules/clean/payments/skus/subscription_status","modules/clean/stormcrow/experiment","modules/core/i18n","modules/clean/payments/skus/sku_content","modules/core/exception","modules/core/uri","modules/core/browser","classnames","modules/clean/stormcrow/stormcrow_exposure_logger","modules/clean/react/growth/trials/components/banner","modules/clean/account_page/widgets/plan/views/montana/montana_modal_flow","modules/clean/account_page/widgets/plan/views/change_schedule_modal","modules/clean/account_page/widgets/plan/views/montana/montana_renew_success_modal","modules/clean/account_page/widgets/plan/views/churn_survey/biz_churn_survey_util","modules/clean/account_page/widgets/plan/views/switch_plan_modal","modules/clean/account_page/widgets/plan/views/cancel_basic_downgrade","modules/clean/account_page/widgets/plan/views/downgrade_confirm_with_covid_promo_modal","modules/clean/account_page/widgets/plusplus/view","modules/clean/hql/index","dropbox/proto/hql_events/retention/retention"],(function(e,t,a,n,s,o,r,l,i,c,u,d,p,m,f,h,g,_,v,b,y,S,w,M,C,E,R,T,x,I,N,P,O,k,A,D,B,L,U,q,F,V,j,W,z,H,Y,Q,K,G,J,X){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=a.__importDefault(s),o=a.__importStar(o),B=a.__importStar(B),U=a.__importStar(U),q=a.__importDefault(q),H=a.__importStar(H);var Z={showIndividualCancelSurvey:!1,showMontanaModalFlow:!1,showMontanaRenewSuccessModal:!1,hasDismissedSavingsBanner:!1,showPlanDetails:!1},$=(function(e){function t(t){var s=e.call(this,t)||this;return s.handleRebillUpsell=function(e){e&&e.showChangePlanConfirm&&E.ChangePlanModalView.showInstance({mode:E.ChangePlanMode.CONFIRM,transitionPerformed:s.forceReload})},s.cancelPlanOnClick=function(){k.Experiment(s.props.planInfo.expMontana).isActive&&s.subStatus&&p.isValidMontanaUserState(s.subStatus,s.props.planInfo)?s.showMontanaModalFlow():s.openIndividualCancelSurvey()},s.forceReload=function(){var e=s.props,t=e.loadEvhInfo,a=e.loadPlanInfo,n=e.forceLoadBillingTab;t(!0),a(!0),n(!0)},s.handleUndoCancellation=function(){P.TeamsWebActionsLogger.log("account_general_undo_cancel"),U.redirect("/team/cancel-downgrade")},s._showIndividualCancelSurvey=function(){P.ProEventsLogger.log("individual_cancel_survey_modal_view",{current_product_plan_type:s.subStatus.subState.plan.productType}),J.logEvent({eventMessageName:"ShownPlusCancelSurveyModal",event:X.hql_events.ShownPlusCancelSurveyModal.create({currentProductPlanType:s.subStatus.subState.plan.productType})}),s.setState({showIndividualCancelSurvey:!0})},s.openIndividualCancelSurvey=function(){s.props.planInfo.currentCovidPromoInfo?K.showDowngradeConfirmWithCovidPromoModal({covidPromoInfo:s.props.planInfo.currentCovidPromoInfo,formattedNextBillingDate:s.subStatus.formattedNextBillingDate,showIndividualCancelSurvey:s._showIndividualCancelSurvey}):s._showIndividualCancelSurvey()},s.openSwitchPlanModal=function(){var e=s.subStatus&&s.subStatus.subState.plan?s.subStatus.subState.plan.productType:M.ProductPlanType.BASIC,t={productType:e,currentBillingScheduleId:s.subStatus&&s.subStatus.subState.billingSchedule?s.subStatus.subState.billingSchedule.id:void 0,finalBillingScheduleId:s.subStatus&&s.subStatus.finalSubState.billingSchedule?s.subStatus.finalSubState.billingSchedule.id:void 0,openChangePlanModal:e!==M.ProductPlanType.BASIC?s.openChangePlanModal:void 0,hasCovidPromo:s.hasCovidPromo};Y.SwitchPlanModalView.showInstance(t)},s.handleSavingsBannerDismissed=function(){s.setState({hasDismissedSavingsBanner:!0})},s.togglePlanDetailsExpand=function(){P.ProEventsLogger.log("de_plan_tab_plan_details_expand_click"),s.setState({showPlanDetails:!s.state.showPlanDetails})},s.showMontanaModalFlow=function(){F.logVariantExposure("montana_master_switch",s.props.planInfo.expMontana),s.setState({showMontanaModalFlow:!0})},s.openMontanaRenewSuccessModal=function(){return a.__awaiter(s,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return[4,this.props.loadPlanInfo(!0,!0)];case 1:return e.sent(),this.setState({showMontanaRenewSuccessModal:!0}),[2]}}))}))},s.closeMontanaRenewSuccessModal=function(){s.setState({showMontanaRenewSuccessModal:!1})},s.hideMontanaModalFlow=function(){s.setState({showMontanaModalFlow:!1})},s.closeIndividualCancelSurvey=function(){s.setState({showIndividualCancelSurvey:!1})},s.openChangePlanModal=function(e,t){var a=!1;if(!e&&p.MontanaLogger.isInitialized()&&"ON"===s.props.planInfo.expMontana){var n=s.props.planInfo,o=n.montanaAnnouncementDate,r=n.usersMontanaMigrationDate,l=n.usersFirstMontanaRebillDate,i=n.now;a=p.getMontanaDateBooleans({montanaAnnouncementDate:o,usersFirstMontanaRebillDate:l,usersMontanaMigrationDate:r,now:i}).isAfterFirstMontanaRebill,p.MontanaLogger.logEvent("cancel_view",{featureType:"change_plan"})}E.ChangePlanModalView.showInstance({transitionPerformed:s.forceReload,expMontana:s.props.planInfo.expMontana,shouldApplyMontanaRetentionPolicy:a,shouldShowRedesignedModal:e,origin:t})},s.openChangeScheduleModal=function(e){var t=s.props,a=t.planInfo,n=t.browserUpdateRequired,o=a.paymentInfo,r=a.expMontana;!e&&p.MontanaLogger.isInitialized()&&p.MontanaLogger.logEvent("cancel_view",{featureType:"yearly_billing"}),W.ChangeScheduleModalView.showInstance({transitionPerformed:s.forceReload,paymentInfo:o,browserUpdateRequired:n,expMontana:r,isMontanaDowngradeFlow:!e,shouldShowRedesignedModal:e})},s.surveyRedirectHandler=function(){var e=s.props.planInfo,t=e.ncctVariant,a=e.isNcctTeam,n=s.isBusinessTrialPlan&&k.Experiment(t).variantIn("V10","V11","V12","V13")&&a?"/team/admin/cancel":"/team/cancel";U.redirect(n)},s.handleTeamCancelPlan=function(){var e=s.props.planInfo,t=e.ncctVariant,a=e.isNcctTeam;P.TeamsWebActionsLogger.log("account_general_cancel_plan");var n=s.props.expRetentionBizChurnSurvey||"OFF",o=s.props.expRetentionBizChurnSurveyTrials||"OFF";H.logExposureIfOn(n,o),"V1"===n||"V1"===o?H.showOriginalBizChurnSurvey(s.props.firstName||"",s.surveyRedirectHandler):"V2"===n||"V2"===o?H.showBizChurnSurvey(s.surveyRedirectHandler):s.isBusinessTrialPlan?k.Experiment(t).variantIn("V10","V11","V12","V13")&&a&&U.redirect("/team/admin/cancel"):U.redirect("/team/admin/billing/manage?start_cancellation")},s.getCancellationType=function(){var e,t;return s.isProfessionalTrialPlan?g.CancellationType.SCHEDULE:(null===(t=null===(e=s.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===M.ProductPlanType.FAMILY_NONPAYER?g.CancellationType.FAMILY_NONPAYER:g.CancellationType.ALL},s.shouldShowExperimentalCancelBasicDowngrade=function(){return s.props.planInfo&&s.props.planInfo.scheduledForDowngrade&&!ee&&(ee=!0,F.logVariantExposure("growth_retention_personal_scheduled_cancellation",s.props.expRetentionPersonalScheduledCancellation)),s.props.planInfo&&s.props.planInfo.scheduledForDowngrade&&"V1"===s.props.expRetentionPersonalScheduledCancellation},_.DBModalStack.register(n.BILLING_INFO_UPDATED,(function(e,t){P.ProEventsLogger.log("de_payment_modal_save_click"),s.props.loadPlanInfo(!0),s.props.forceLoadBillingTab(!0),s.handleRebillUpsell(t)})),s.state=a.__assign({},Z),s}return a.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;l.mark_time_to_view(),this.props.loadPlanInfo().then((function(){e.shouldRenderBillingNotifications()&&P.TeamsWebActionsLogger.log("scheduled_cancel_notif_view")})),this.props.loadReferralHistory(),this.props.loadEvhInfo(),this.checkTTIstate(),P.ProEventsLogger.log("de_plan_tab_view"),l.waitForTTI().then((function(){e.openModalFromUrl()}))},t.prototype.componentDidUpdate=function(){this.checkTTIstate()},t.prototype.openModalFromUrl=function(){var e=L.URI.parse(U.get_href()).getQuery().modal;if(e)switch(e){case"individual_cancel_survey":return this.cancelPlanOnClick();case"montana_modal_flow":if(k.Experiment(this.props.planInfo.expMontana).isActive)return this.showMontanaModalFlow();break;case"change_schedule":return this.openChangeScheduleModal();case"plus_to_family":return this.openChangePlanModal(!1,E.ChangePlanOrigin.PLUS_TO_FAMILY);default:return}},t.prototype.checkTTIstate=function(){if(this.props.dataLoadedForTTI){var e=void 0;if(k.Experiment(this.props.expRetentionAccountWayfinding).isActive)e="plan-tab-plus-merged-account";else if(this.props.expRenewBizMergeTabsOnAccount)e="plan-tab-biz-merged-account";else if(this.subStatus&&this.subStatus.subState.plan)switch(this.subStatus.subState.plan.productFamily){case M.ProductFamily.PRO:e="plan-tab-plus-pro";break;case M.ProductFamily.TEAM:case M.ProductFamily.ENTERPRISE:e="plan-tab-team";break;case M.ProductFamily.EDUCATION:e="plan-tab-education";break;case M.ProductFamily.FAMILY:e="plan-tab-family"}else e="plan-tab-basic";var t=void 0;e&&(t={subtypes:JSON.stringify({tti_flow:e})}),l.mark_time_to_interactive(t)}},Object.defineProperty(t.prototype,"isPersonalUser",{get:function(){return"personal"===i.getCurrentUser().role},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBusinessUser",{get:function(){return!this.isPersonalUser},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLicensePlan",{get:function(){var e=this.props.planInfo;if(!e)return!1;var t=e.paymentInfo;return t&&c.isLicenseKey(t.gateway_id)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasLicenseKey",{get:function(){var e=this.props.planInfo;return!!e&&e.hasLicenseKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLimitedTeam",{get:function(){return this.props.planInfo.isLimitedTeam},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLockedTeam",{get:function(){return this.props.planInfo.isLockedTeam},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subStatus",{get:function(){var e=this.props.planInfo.serializedSubStatus;if(e)return O.SubscriptionStatus.deserialize(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isExternallyBilled",{get:function(){return void 0===this.subStatus},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPlusTrialPlan",{get:function(){return!(!this.subStatus||!this.subStatus.subState.plan)&&(this.subStatus.subState.plan.productType===M.ProductPlanType.TRIAL||this.subStatus.subState.plan.productType===M.ProductPlanType.PLUS_TRIAL)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isProfessionalTrialPlan",{get:function(){return!(!this.subStatus||!this.subStatus.subState.plan)&&this.subStatus.subState.plan.productType===M.ProductPlanType.PROFESSIONAL_TRIAL},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBusinessTrialPlan",{get:function(){return!(!this.subStatus||!this.subStatus.subState.plan)&&(this.subStatus.subState.plan.productType===M.ProductPlanType.STANDARD_TRIAL||this.subStatus.subState.plan.productType===M.ProductPlanType.ADVANCED_TRIAL)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasCovidPromo",{get:function(){return Boolean(this.props.planInfo.currentCovidPromoInfo)},enumerable:!0,configurable:!0}),t.prototype.isLoading=function(){return"ready"!==this.props.loadingState},t.prototype.renderAddOnsIfAvailable=function(){var e=this.props,t=e.evhInfo,a=e.evhLoadingState,n=e.planInfo,o=this.props.planInfo,r=o.paymentMethod,l=o.paymentInfo;if(!this.isLicensePlan&&t.is_available&&this.subStatus&&this.subStatus.subState.plan&&this.subStatus.subState.plan.productType!==M.ProductPlanType.FREE&&(this.isPersonalUser||this.isLimitedTeam))return s.default.createElement(u.AddOns,{subStatus:this.subStatus,scheduledForDowngrade:n.scheduledForDowngrade,evhInfo:t,evhLoadingState:a,paymentInfo:l,paymentMethod:r,transitionPerformed:this.forceReload})},t.prototype.renderUsageBreakdown=function(){var e=this.props.planInfo,t=e.isMSLUserOn,a=e.usageBreakdown,n=e.isTeamAdmin,o=e.plusSkuContent,r=e.isLimitedTeam;if(this.isPersonalUser||t||r)return s.default.createElement(R.QuotaUsage,{subStatus:this.subStatus,usageBreakdown:a,isPersonalUser:this.isPersonalUser,isLimitedTeam:this.isLimitedTeam,isIndividualBreakdownMSL:t,isTeamAdmin:n,plusSkuContent:o,expRetentionAccountWayfinding:this.props.expRetentionAccountWayfinding})},t.prototype.renderTotalTeamUsageBreakdown=function(){var e=this.props.planInfo,t=e.teamUsageBreakdown,a=e.plusSkuContent,n=e.isTeamAdmin;if(t)return s.default.createElement(R.QuotaUsage,{subStatus:this.subStatus,usageBreakdown:t,isPersonalUser:!1,isLimitedTeam:!1,isIndividualBreakdownMSL:!1,plusSkuContent:a,isTeamAdmin:n,isMergedTab:this.props.expRenewBizMergeTabsOnAccount})},t.prototype.renderUpsell=function(){var e,t,a,n=this.props.planInfo,o=n.ncctVariant,r=n.isNcctTeam,l=n.serializedSubStatus,i=n.standardSkuContent,c=D.SkuContentClient.deserialize(i);return B.assert(!c.hasUnlimitedSpace(),"Unlimited space is not implemented yet"),k.Experiment(o).variantIn("V10","V11","V12","V13")&&r?(e=A.intl.formatMessage({id:"Aquro6",defaultMessage:"Want to keep using Dropbox with your team?"}),t=A.intl.formatMessage({id:"0Rr7nB",defaultMessage:"Add your billing information so you don’t have to later. You’ll still get the remaining days in your trial for free, and you won’t be charged until {trial_end_date} after your free trial ends."},{trial_end_date:l.subState.formattedNextBillingDate}),a={text:A.intl.formatMessage({id:"3gzYYX",defaultMessage:"Keep {trademark_business}"},{trademark_business:C.TRADEMARK_BUSINESS}),link:"/business/billing"},s.default.createElement(m.UpsellModule,{headline:e,text:t,cta:a})):null},t.prototype.renderBillingNotifications=function(){var e=A.intl.formatMessage({id:"vGtzPG",defaultMessage:"You are scheduled to cancel {trademark_business} on {date}. Are you sure?"},{trademark_business:C.TRADEMARK_BUSINESS,date:this.subStatus.subState.formattedNextBillingDate}),t=A.intl.formatMessage({id:"gTl8rn",defaultMessage:"Undo"});return s.default.createElement("div",{className:"billing-notification-view"},s.default.createElement("h1",{className:"description f2"},e),s.default.createElement("button",{className:"link-button",onClick:this.handleUndoCancellation},t))},t.prototype.shouldRenderBillingNotifications=function(){if(this.props.expRenewBizMergeTabsOnAccount&&!this.isBusinessTrialPlan&&this.isBusinessUser&&!this.isLockedTeam){var e=this.subStatus;return Boolean(e&&e.finalSubState&&!e.finalSubState.plan)}return!1},t.prototype.render=function(){var e=this,t=this.props,n=t.browserUpdateRequired,o=t.trialsConfig,r=t.evhInfo,l=t.firstName,u=t.profile,m=t.accountPreferences,_=t.companyInfo,v=t.deleteAccountRow,b=t.expRetentionAccountWayfinding,y=t.expRetentionAccountChanges,S=t.expRetentionAccountChangesBasic,M=t.expRetentionPersonalScheduledCancellation,E=this.props.planInfo,R=E.usageBreakdown,P=E.referralInfo,O=E.scheduledForDowngrade,B=E.paymentInfo,L=E.eligibleFor1tb,U=E.isTeamAdmin,F=E.hasLicenseKey,W=E.hasUnusedLicenseKey,H=E.expMontana,Y=E.basicSkuContent,K=E.hasPreviouslyDismissedSavingsBanner,J=E.plusSkuContent,X=E.currentCovidPromoInfo,Z=E.expRetentionCovidPromo,$=E.endPromoDate,ee=this.subStatus,te=this.props.expRenewBizMergeTabsOnAccount,ae=k.Experiment(b).isActive,ne=k.Experiment(y).isActive;if(this.isLoading())return s.default.createElement(T.Loading,null);var se=void 0;if(!this.isExternallyBilled&&!O&&!this.isProfessionalTrialPlan&&(this.isPersonalUser||this.isLimitedTeam)&&B&&!c.shouldHideBillingChange(B.gateway_id,B.is_reseller_billing)&&(!o||!o.hideCancelPlan)&&!k.Experiment(b).variantIs("V2")){var oe={expRetentionAccountWayfinding:b};se=s.default.createElement(f.CancelPlan,{experiments:oe,usageBreakdown:R,subStatus:ee,eligibleFor1tb:L,basicSkuContent:Y,onClick:this.cancelPlanOnClick})}te&&ee&&ee.finalSubState&&ee.finalSubState.plan&&(se=this.isBusinessTrialPlan?s.default.createElement(x.ButtonBlock,{label:A.intl.formatMessage({id:"Ly7g3J",defaultMessage:"Cancel your trial"}),subtext:A.intl.formatMessage({id:"tqbX4V",defaultMessage:"Cancel your {trademark_business} trial"},{trademark_business:C.TRADEMARK_BUSINESS}),buttonText:A.intl.formatMessage({id:"pAJcJV",defaultMessage:"Cancel trial"}),kind:"secondary",buttonAction:{kind:"function",handler:this.handleTeamCancelPlan}}):s.default.createElement(x.ButtonBlock,{label:A.intl.formatMessage({id:"JUHBC3",defaultMessage:"Cancel your plan"}),subtext:A.intl.formatMessage({id:"RE2u+V",defaultMessage:"Cancel your {trademark_business} plan"},{trademark_business:C.TRADEMARK_BUSINESS}),buttonText:A.intl.formatMessage({id:"HrdTOS",defaultMessage:"Cancel plan"}),kind:"secondary",buttonAction:{kind:"function",handler:this.handleTeamCancelPlan}}));var re,le=this.isBusinessUser&&!this.isLimitedTeam||ae?void 0:s.default.createElement(I.ReferralSpace,{referralInfo:P,referralHistory:this.props.referralHistory,referralLoadingState:this.props.referralLoadingState,onLoadMoreReferralHistory:this.props.loadReferralHistory}),ie=this.getCancellationType();this.isExternallyBilled||this.isLicensePlan||this.isPlusTrialPlan||!this.isPersonalUser&&!this.isLimitedTeam||this.hasLicenseKey||(re=s.default.createElement(N.CancellableNotificationsView,{paymentInfo:B,subStatus:ee,scheduledForDowngrade:O,transitionPerformed:this.forceReload,displaySingleChangeCancellationItem:ie,reOpenModalDialogAfterCancellation:!1,displayNewTotal:!0,shouldShowForDowngradeToBasic:ae&&!this.shouldShowExperimentalCancelBasicDowngrade(),shouldShowRedesignedModal:ne}));var ce,ue={openIndividualCancelSurvey:this.openIndividualCancelSurvey,openSwitchPlanModal:this.openSwitchPlanModal},de=K||this.state.hasDismissedSavingsBanner||k.Experiment(M).isActive&&O,pe=s.default.createElement(w.PlanStatus,{browserUpdateRequired:n,subStatus:ee,scheduledForDowngrade:O,showTeamScheduledForDowngrade:!1,evhInfo:r,onUpdate:this.forceReload,isPersonalUser:this.isPersonalUser,isLimitedTeam:this.isLimitedTeam,isExternallyBilled:this.isExternallyBilled,paymentInfo:B,isTeamAdmin:U,hasLicenseKey:F,hasUnusedLicenseKey:W,usageBreakdown:R,eligibleFor1tb:L,showCancelButton:!1,showChangeBillingPeriod:!0,isLoggedInUser:!0,isLoggedInAsTransactionOwner:!0,useSpecifiedRole:!1,isMergedTab:te,trialsConfig:o,modalCallbacks:ue,expMontana:this.props.planInfo.expMontana,hideSavingsBanner:de,onSavingsBannerDismissed:this.handleSavingsBannerDismissed,expRetentionAccountWayfinding:b,handlePlanDetailsExpand:this.togglePlanDetailsExpand,shouldShowPlanDetails:this.state.showPlanDetails,plusSkuContent:J,shouldShowRedesignedModal:ne,expRetentionAccountChanges:y,expRetentionAccountChangesBasic:S,hasUnappliedMonthlyCovidPromo:Boolean(X&&X.is_monthly&&X.user_facing_months_left===g.COVID_PROMO_LENGTH)});o&&o.trialBanner&&o.currentPlan&&o.trialPlan&&(ce=s.default.createElement(V.TrialsBanner,a.__assign({firstName:l,userId:i.getCurrentUser().id},o)));var me,fe=q.default({"account-page-block":!0,"account-page-block--general":te,"account-page-block--merged":!te}),he={firstName:l,onClose:this.closeIndividualCancelSurvey,expMontanaActive:k.Experiment(H).isActive&&this.subStatus&&p.isValidMontanaUserState(this.subStatus,this.props.planInfo),nextModal:function(){},prevModal:function(){},exitModalFlow:function(){},goToModal:function(){},modalFlowState:{},basicSkuQuotaGb:D.SkuContentClient.deserialize(Y).spaceShortFormGb(),expRetentionCovidPromo:Z,endPromoDate:$,reloadData:this.forceReload,hasOrHadCovidPromo:this.props.planInfo.hasOrHadCovidPromo};return this.subStatus&&B&&!O&&!this.isPlusTrialPlan&&ae&&(me=s.default.createElement(h.BillingSummary,{subStatus:this.subStatus,paymentInfo:B,onCtaClick:function(){return e.openChangeScheduleModal(ne)}})),s.default.createElement("div",{className:"account-plan-tab"},te?this.renderUpsell():null,this.shouldRenderBillingNotifications()?this.renderBillingNotifications():null,te?u:null,s.default.createElement("div",{className:fe},te?s.default.createElement("div",{className:"plan-page-header"},A.intl.formatMessage({id:"WGMqEP",defaultMessage:"PLAN"})):null,re,te?null:this.renderUpsell(),ce,this.state.showIndividualCancelSurvey&&this.subStatus&&s.default.createElement(d.IndividualCancelSurveyModal,a.__assign({subStatus:this.subStatus},he)),this.state.showMontanaModalFlow&&this.subStatus&&s.default.createElement(j.MontanaModalFlow,{firstName:l,subStatus:this.subStatus,onClose:this.hideMontanaModalFlow,planInfo:this.props.planInfo,openChangePlanModal:this.openChangePlanModal,openChangeScheduleModal:this.openChangeScheduleModal,openMontanaRenewSuccessModal:this.openMontanaRenewSuccessModal}),this.state.showMontanaRenewSuccessModal&&this.subStatus&&s.default.createElement(z.RenewSuccessModal,{subStatus:this.subStatus,planInfo:this.props.planInfo,onClose:this.closeMontanaRenewSuccessModal}),pe,this.shouldShowExperimentalCancelBasicDowngrade()&&ee&&s.default.createElement(Q.CancelBasicDowngradeWithCss,{planEndDate:ee.formattedNextBillingDate,billingScheduleId:ee.subState.billingSchedule.id,transitionPerformed:this.forceReload,shouldShowRedesignedModal:ne}),this.renderAddOnsIfAvailable(),this.renderUsageBreakdown(),this.renderTotalTeamUsageBreakdown(),le,me,se),te?_:null,te?m:null,te?s.default.createElement(G.PlusPlusFeatures,{isPasswordsEnabled:this.props.isPasswordsEnabled,isVaultEnabled:this.props.isVaultEnabled}):null,te?v:null)},t})(s.default.Component);t.PlanContainerComponent=$;var ee=!1,te=o.connect((function(e,t){return{browserUpdateRequired:t.browserUpdateRequired,expRenewBizMergeTabsOnAccount:t.expRenewBizMergeTabsOnAccount,profile:t.profile,accountPreferences:t.accountPreferences,companyInfo:t.companyInfo,deleteAccountRow:t.deleteAccountRow,firstName:t.firstName,evhInfo:e.planTab.evhInfo,evhLoadingState:e.planTab.evhLoadingState,planInfo:e.planTab.planInfo,loadingState:e.planTab.loadingState,referralHistory:e.planTab.referralHistory,referralLoadingState:e.planTab.referralLoadingState,dataLoadedForTTI:"ready"===e.planTab.evhLoadingState&&"ready"===e.planTab.loadingState&&"ready"===e.planTab.referralLoadingState,expRetentionBizChurnSurvey:t.expRetentionBizChurnSurvey,expRetentionBizChurnSurveyTrials:t.expRetentionBizChurnSurveyTrials,expRetentionAccountWayfinding:t.expRetentionAccountWayfinding,expRetentionAccountChanges:t.expRetentionAccountChanges,expRetentionAccountChangesBasic:t.expRetentionAccountChangesBasic,expRetentionPersonalScheduledCancellation:t.expRetentionPersonalScheduledCancellation,isVaultEnabled:t.isVaultEnabled,isPasswordsEnabled:t.isPasswordsEnabled}}),(function(e){return{loadPlanInfo:function(t,a){return e(v.loadDataIfNecessary(t,a))},loadEvhInfo:function(t){return e(y.loadEvhInfoIfNecessary(t))},loadReferralHistory:function(){return e(S.loadReferralHistoryIfNecessary())},forceLoadBillingTab:function(t){return e(b.loadDataIfNecessary(t))}}}))($);t.PlanContainer=r.requireCssWithComponent(te,["/static/css/account/pagelet/plan_tab-vfliVG81k.css"])})),define("modules/clean/account_page/widgets/plan/views/quota_usage",["require","exports","tslib","react","classnames","modules/core/browser","modules/clean/react/css","modules/clean/viewer","modules/clean/account_page/util","modules/core/i18n","modules/clean/display_format","modules/constants/trademark","modules/clean/payments/skus/sku_content","modules/clean/analytics","modules/clean/account_page/components/key_value_block","modules/clean/stormcrow/experiment","modules/clean/payments/skus/constants"],(function(e,t,a,n,s,o,r,l,i,c,u,d,p,m,f,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),s=a.__importDefault(s),o=a.__importStar(o);var _=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.formatBytes=function(e){return u.format_bytes(e,2,!0,!0,!1)},t.onClickAdvancedUpgrade=function(e){e.preventDefault(),o.redirect("/team/admin/billing/manage")},t.logUpgradeOverquotaLink=function(e){m.GrowthEventsLogger.log("acc_plan_upgrade_overquota_link",{action:e,button_text:"Upgrade now",destination_url:"http://www.dropbox.com/upgrade",location:"in_product",quota_status:"over",upsell_type:"modal"})},t.handleOQLinkClick=function(){t.logUpgradeOverquotaLink("click")},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){this.isOverQuota&&this.logUpgradeOverquotaLink("view")},Object.defineProperty(t.prototype,"teamName",{get:function(){return l.Viewer.get_viewer().team_name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"freeSpace",{get:function(){var e=this.props.usageBreakdown;return e.quota-e.usage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sharedFiles",{get:function(){return this.props.usageBreakdown.shared_usage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"regularFiles",{get:function(){return this.props.usageBreakdown.unshared_usage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"usage",{get:function(){return this.props.usageBreakdown.usage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"quota",{get:function(){return this.props.usageBreakdown.quota||.01},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isOverQuota",{get:function(){return this.usage>this.quota},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFamilyUser",{get:function(){var e,t;return(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productFamily)===g.ProductFamily.FAMILY},enumerable:!0,configurable:!0}),t.prototype.getQuotaUpsell=function(){var e=this,t=this.props,a=t.subStatus,s=t.isPersonalUser,o=t.isLimitedTeam,r=t.isIndividualBreakdownMSL,l=t.isTeamAdmin,i=t.plusSkuContent;if(a){var u=p.SkuContentClient.deserialize(i),m=null,f=a.subState.plan,h=n.default.createElement("span",null,c.intl.formatMessage({id:"z0bwcg",defaultMessage:"When your team runs out of space, accounts will stop syncing and you won’t be able to add any new files."})," ");return s||o?!f&&this.isOverQuota&&u.spaceLongFormRounded()&&(m=n.default.createElement("div",{className:"quota-upsell"},c.intl.formatMessage({id:"Wm6cD6",defaultMessage:"With {plan}, get {plus_space_long_form_rounded} for all your photos, videos, docs and other files. Keep everything stored safely and at your fingertips."},{plan:d.TRADEMARK_PLUS,plus_space_long_form_rounded:u.spaceLongFormRounded()})," ",n.default.createElement("a",{href:"/upgrade?oqa=acc_plan_upgrade_overquota_link",onClick:this.handleOQLinkClick},c.intl.formatMessage({id:"CagMem",defaultMessage:"Upgrade now"})))):r?this.isOverQuota&&(m=n.default.createElement("div",{className:"quota-upsell"},c.intl.formatMessage({id:"UD6TiK",defaultMessage:"Your Dropbox account is full. To continue, remove files or ask your admin for more space."}),n.default.createElement("a",{href:"/help/business/space-limit-full"},c.intl.formatMessage({id:"K2PjtT",defaultMessage:"Learn more about Dropbox space"})))):f&&(f.isAdvancePlan||f.isLegacyPlan)?m=n.default.createElement("div",{className:"quota-upsell"},h,l?c.intl.formatMessage({id:"52Wsye",defaultMessage:"To add more space, <a>contact support</a>."},{a:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.default.createElement("a",{href:"/support",target:"_blank",rel:"noopener noreferrer"},e)}}):c.intl.formatMessage({id:"niJq3p",defaultMessage:"Contact your admin to add more space."})):f&&f.isEnterprise||(m=n.default.createElement("div",{className:"quota-upsell"},h,l?c.intl.formatMessage({id:"ARdJGs",defaultMessage:"<a>Upgrade to an Advanced plan</a> to get more space."},{a:function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return n.default.createElement("a",{href:"",onClick:e.onClickAdvancedUpgrade},t)}}):c.intl.formatMessage({id:"B+5CcZ",defaultMessage:"Contact your admin to upgrade to an <a>Advanced plan</a> and get more space."},{a:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.default.createElement("a",{href:"/business/plans-comparison",target:"_blank",rel:"noopener noreferrer"},e)}}))),m}},t.prototype.render=function(){var e,t=this.props,a=t.isPersonalUser,o=t.isLimitedTeam,r=t.isIndividualBreakdownMSL,l=t.expRetentionAccountWayfinding,u="",d=c.intl.formatMessage({id:"BdUKjA",defaultMessage:"Using <strong>{usage}</strong> of {quota}"},{usage:this.formatBytes(this.usage),quota:this.formatBytes(this.quota),strong:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.default.createElement("strong",{key:"quota-strong"},e)}});a||o?this.isFamilyUser?(u=this.isOverQuota?c.intl.formatMessage({id:"39gFed",defaultMessage:"Your Dropbox Family plan is out of space"}):c.intl.formatMessage({id:"rbSlq+",defaultMessage:"Dropbox Family space"}),e=c.intl.formatMessage({id:"nlxpt6",defaultMessage:"Storage space is shared by all members of the Family plan."})):u=this.isOverQuota?c.intl.formatMessage({id:"QYDt5S",defaultMessage:"Your Personal Dropbox account is full"}):c.intl.formatMessage({id:"GQB5zk",defaultMessage:"Personal Dropbox space"}):u=r?this.isOverQuota?c.intl.formatMessage({id:"jETKiQ",defaultMessage:"Your Dropbox account space is full"}):c.intl.formatMessage({id:"Otg1Lv",defaultMessage:"Your Dropbox account space"}):this.isOverQuota?c.intl.formatMessage({id:"GxuR0v",defaultMessage:"Your {team_name} account is full"},{team_name:this.teamName}):c.intl.formatMessage({id:"Yk84rP",defaultMessage:"{team_name} — space"},{team_name:this.teamName});var p=100*this.regularFiles/this.quota,m=(p>100?"100":p.toFixed(20))+"%",g=100*this.sharedFiles/this.quota,_={width:m},v={width:(g>100?"100":g.toFixed(20))+"%"},b=s.default({"account-plan-tab-quota-usage":!0,"is-within-quota":!this.isOverQuota,"is-over-quota":this.isOverQuota,"is-merged-tab":this.props.isMergedTab}),y=s.default({"bar-graph-part":!0,"bar-graph-normal":!0,"normal-color":!0,"is-zero":0===this.usage}),S=s.default({"bar-graph-part":!0,"bar-graph-shared":!0,"bar-shared-color":!0,"is-zero":0===this.sharedFiles}),w=s.default({"bar-graph-legend":!0,"bar-graph-normal":!0,"normal-color":!0}),M=s.default({"bar-graph-legend":!0,"bar-graph-shared":!0,"shared-color":!0}),C=this.getQuotaUpsell(),E=this.isOverQuota?void 0:n.default.createElement("div",{className:"bar-graph-legend-group"},n.default.createElement("div",{className:"bar-graph-legend bar-graph-free"}),n.default.createElement("span",{className:"bar-graph-key-text"},c.intl.formatMessage({id:"opGguN",defaultMessage:"Unused space ({freeSpace})"},{freeSpace:this.formatBytes(this.freeSpace)}))),R=s.default({"quota-header quota-header__usage_merged_tab":this.props.isMergedTab,"quota-header quota-header__usage":!this.props.isMergedTab});if(h.Experiment(l).isActive){var T=this.usage/this.quota,x=c.intl.formatMessage({id:"/SW/qm",defaultMessage:"Using <b>{percent, number, ::percent}</b> of space ({usage} of {quota})"},{percent:T,usage:this.formatBytes(this.usage),quota:this.formatBytes(this.quota),b:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.default.createElement("b",null,e)}});return T<.01&&(x=c.intl.formatMessage({id:"/dCeu0",defaultMessage:"Using <b>less than {percentage, number, ::percent}</b> of space ({usage} of {quota})"},{percentage:.01,usage:this.formatBytes(this.usage),quota:this.formatBytes(this.quota),b:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.default.createElement("b",null,e)}})),n.default.createElement(f.KeyValueBlock,{className:"quota-usage-key-value",keyText:x,linkText:c.intl.formatMessage({id:"iIucBq",defaultMessage:"Get more space"}),onLinkClick:i.logClickAndRedirect("de_get_more_space_click","/plans",{})})}return n.default.createElement("div",{className:b},n.default.createElement("div",{className:"quota-plan-detail"},n.default.createElement("span",{className:"quota-header quota-header__plan"},u,e&&n.default.createElement("div",{className:"quota-header quota-header__subtext"},e)),n.default.createElement("span",{className:R},d)),n.default.createElement("div",{className:"quota-space-bar"},n.default.createElement("div",{className:"bar-graph"},n.default.createElement("div",{className:y,style:_}),n.default.createElement("div",{className:S,style:v}))),n.default.createElement("div",{className:"quota-space-legend"},n.default.createElement("div",{className:"bar-graph-key"},n.default.createElement("div",{className:"space-key"},n.default.createElement("div",{className:"bar-graph-legend-group"},n.default.createElement("div",{className:w}),n.default.createElement("span",{className:"bar-graph-key-text"},c.intl.formatMessage({id:"tunaZf",defaultMessage:"Regular files ({fileSize})"},{fileSize:this.formatBytes(this.regularFiles)}))),n.default.createElement("div",{className:"bar-graph-legend-group"},n.default.createElement("div",{className:M}),n.default.createElement("span",{className:"bar-graph-key-text"},c.intl.formatMessage({id:"Q2mX2B",defaultMessage:"Shared files ({fileSize})"},{fileSize:this.formatBytes(this.sharedFiles)}))),E))),C)},t})(n.default.Component);t.QuotaUsageView=_,t.QuotaUsage=r.requireCssWithComponent(_,["/static/css/account/pagelet/quota_usage-vfl1zyfWk.css"])})),define("modules/clean/account_page/widgets/plan/views/referral_space",["require","exports","tslib","modules/core/browser","react","modules/clean/react/css","modules/core/i18n","modules/clean/static_urls","modules/clean/account_page/components/account_table","modules/clean/account_page/components/button_block","modules/clean/analytics"],(function(e,t,a,n,s,o,r,l,i,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importStar(n),s=a.__importDefault(s),t.ReferralRow=function(e){var t=e.row,a=null,n=null;return a=t.type.url?s.default.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:t.type.url},t.type.str):s.default.createElement("span",null,t.type.str),n=t.earned.completed?s.default.createElement("div",null,s.default.createElement("span",{className:"earned-space"},t.earned.str),s.default.createElement("img",{src:l.static_url("/static/images/icon_checkmark-vflExOh3Y.png"),alt:""})):t.earned.url?s.default.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:t.earned.url},t.earned.str):s.default.createElement("span",null,t.earned.str),s.default.createElement(i.BodyRow,{className:"referral-body-row",key:t.details+t.updated},s.default.createElement(i.BodyCell,{className:"referral-bonus-type"},a),s.default.createElement(i.BodyCell,{className:"referral-description"},t.details),s.default.createElement(i.BodyCell,{className:"referral-updated"},t.updated),s.default.createElement(i.BodyCell,{className:"referral-earned"},n))};var d=(function(e){function o(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={showMore:!1},n.buildReferralHistoryIfNecessary=function(){var e=n.props.referralHistory;if(null!==e&&null!==e.rows&&0!==e.rows.length)return s.default.createElement("div",{className:"referral-table-container"},s.default.createElement(i.Table,{className:"referral-table"},s.default.createElement(i.TableHead,null,s.default.createElement(i.HeaderRow,{className:"referral-header-row"},s.default.createElement(i.HeaderCell,{className:"referral-bonus-type-header"},r.intl.formatMessage({id:"62TVke",defaultMessage:"Bonus type"})),s.default.createElement(i.HeaderCell,{className:"referral-description-header"}),s.default.createElement(i.HeaderCell,{className:"referral-updated-header"},r.intl.formatMessage({id:"8vhXDd",defaultMessage:"Updated"})),s.default.createElement(i.HeaderCell,{className:"referral-earned-header"},r.intl.formatMessage({id:"Cj1p0k",defaultMessage:"Space earned"})))),s.default.createElement(i.TableFooter,{className:"referral-footer"},n.buildReferralFooter()),s.default.createElement(i.TableBody,null,e.rows.map((function(e,a){if(n.state.showMore||!(a>2))return s.default.createElement(t.ReferralRow,{row:e,key:e.id})})))))},n.loadMoreReferralHistory=function(e){return a.__awaiter(n,void 0,void 0,(function(){return a.__generator(this,(function(t){return u.ProEventsLogger.log("de_earn_space_view_more_click"),e.preventDefault(),this.state.showMore?(this.props.onLoadMoreReferralHistory(),[2,!1]):(this.setState({showMore:!0}),[2,!1])}))}))},n.buildReferralFooter=function(){var e=n.props.referralHistory;return"loading"===n.props.referralLoadingState?s.default.createElement("tr",{className:"referral-footer-row"},s.default.createElement("td",{colSpan:4},s.default.createElement("img",{src:l.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:r.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})}))):!n.state.showMore&&e.rows.length<3||n.state.showMore&&!e.has_more?void 0:s.default.createElement("tr",{className:"referral-footer-row"},s.default.createElement("td",{colSpan:4},s.default.createElement("a",{onClick:n.loadMoreReferralHistory,href:"#",rel:"noopener noreferrer"},r.intl.formatMessage({id:"JkU5zc",defaultMessage:"View more earned space"}))))},n}return a.__extends(o,e),o.prototype.buildInvitePhrase=function(e){return r.intl.formatMessage({id:"7TJxA6",defaultMessage:"You can earn more space by referring your friend to Dropbox! You’ll get a {referral_amount} bonus when they install Dropbox on their computer."},{referral_amount:e})},o.prototype.isLoadingInitially=function(){return"ready"!==this.props.referralLoadingState&&0===this.props.referralHistory.rows.length},o.prototype.inviteFriendClick=function(){u.ProEventsLogger.log("de_earn_space_invite_click"),n.redirect("/referrals")},o.prototype.render=function(){if(this.isLoadingInitially())return s.default.createElement("div",{className:"loading-indicator"},s.default.createElement("img",{src:l.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:r.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})}));var e=this.props.referralInfo;return s.default.createElement("div",{className:"referral-space"},s.default.createElement(c.ButtonBlock,{label:r.intl.formatMessage({id:"mVEUU0",defaultMessage:"Earn more space ({current_space} earned)"},{current_space:e.currentSpace}),subtext:this.buildInvitePhrase(e.referralAmount),buttonText:r.intl.formatMessage({id:"PuT77r",defaultMessage:"Invite a friend"}),kind:"secondary",buttonAction:{kind:"function",handler:this.inviteFriendClick}}),this.buildReferralHistoryIfNecessary())},o})(s.default.Component);t.ReferralSpace=o.requireCssWithComponent(d,["/static/css/account/pagelet/referral_space-vfl1137Lw.css"])})),define("modules/clean/react/growth/features/cta",["require","exports","tslib","react","spectrum/button","modules/clean/react/growth/features/util","modules/clean/react/css"],(function(e,t,a,n,s,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),t.CtaComponent=function(e){var t=e.component,a=e.cta,r=e.project,l=e.showLoader,i=void 0===l||l,c=e.size,u=e.submitting,d=e.userId,p=e.variant,m=a.text;if(!m)return null;var f=!!e.disabled||!!u,h=f?void 0:o.getOnClickHandlerForCta(r,t,a,d),g=n.default.createElement("div",{className:"growth-features-cta__loader"},n.default.createElement("span",{className:"loader__dot"}),n.default.createElement("span",{className:"loader__dot"}),n.default.createElement("span",{className:"loader__dot"}));return n.default.createElement(s.Button,{className:"growth-features-cta",disabled:f,onClick:h,size:c,variant:p},u&&i&&"primary"===p?g:m)},t.Cta=r.requireCssWithComponent(t.CtaComponent,["/static/css/react/growth/features/cta-vfl-MCeW7.css"])})),define("modules/clean/react/growth/trials/components/banner",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/growth/trials/types","modules/clean/react/growth/logging_util","modules/clean/react/growth/features/cta","modules/clean/react/css","modules/clean/react/growth/trials/components/modals/cancel_trial_survey_loader","modules/clean/payments/skus/sku_content"],(function(e,t,a,n,s,o,r,l,i,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.showCancelTrialSurveyModal=function(){var e=t.props,a=e.currentPlan,n=e.firstName,s=e.project,l=e.trialPlan,i=e.trialSource,u=e.userId;r.logCtaClick(s,r.ComponentName.TRIAL_BANNER,r.CtaType.OPEN_MODAL,{modalType:o.ModalType.CANCEL_TRIAL_SURVEY}),n&&c.showCancelTrialSurveyModal(n,u,{currentPlan:a,project:s,trialPlan:l,trialSource:i})},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){r.logDisplay(this.props.project,r.ComponentName.TRIAL_BANNER)},t.prototype.renderFeatures=function(e){if(!e||!e.length)return null;var t=e.map((function(e,t){return n.default.createElement("li",{key:t},e)}));return n.default.createElement("ul",{className:"growth-trials-banner__features"},t)},t.prototype.render=function(){var e=this.props,t=e.trialBanner,a=e.currentPlan,o=e.project,i=e.trialPlan;if(!t)return null;var c=t.description,d=t.features,p=t.primaryCTA,m=t.secondaryCTA,f=i.autoConvertEnabled,h=i.endDate,g=i.isMobileTrial,_=r.ComponentName.TRIAL_BANNER,v=u.SkuContentClient.deserialize(a.skuContent),b=u.SkuContentClient.deserialize(i.skuContent);return n.default.createElement("div",{className:"growth-trials-banner"},n.default.createElement("div",{className:"growth-trials-banner__content"},n.default.createElement("h1",{className:"growth-trials-banner__title"},s.intl.formatMessage({id:"OUyDaO",defaultMessage:"{dropbox_trial_plan_name} trial"},{dropbox_trial_plan_name:b.dropboxDisplayName()})),n.default.createElement("div",{className:"growth-trials-banner__terms-and-conditions"},f?s.intl.formatMessage({id:"19Hg2E",defaultMessage:"Your free trial of {dropbox_trial_plan_name} will end on {trial_end_date}. If you don’t cancel your free trial by then, you will be billed for your {dropbox_trial_plan_name} subscription."},{dropbox_trial_plan_name:b.dropboxDisplayName(),trial_end_date:h}):s.intl.formatMessage({id:"CYkszS",defaultMessage:"Your free trial of {dropbox_trial_plan_name} will end on {trial_end_date}. If you don’t purchase {dropbox_trial_plan_name} by the end of your trial, you’ll go back to {dropbox_current_plan_name}."},{dropbox_current_plan_name:v.dropboxDisplayName(),dropbox_trial_plan_name:b.dropboxDisplayName(),trial_end_date:h})),c&&n.default.createElement("div",{className:"growth-trials-banner__description"},c),this.renderFeatures(d),m&&n.default.createElement(l.Cta,{component:_,cta:m,project:o,variant:"styleless"}),!g&&n.default.createElement(l.Cta,{component:_,cta:{text:s.intl.formatMessage({id:"h/jNg2",defaultMessage:"Cancel trial"}),onClick:this.showCancelTrialSurveyModal},project:o,variant:"styleless"})),!f&&!g&&p&&n.default.createElement(l.Cta,{component:_,cta:p,project:o,variant:"primary"}))},t})((n=a.__importDefault(n)).default.PureComponent);t.TrialsBannerComponent=d,t.TrialsBanner=i.requireCssWithComponent(d,["/static/css/react/growth/trials/components/banner-vflN7p3tA.css"])})),define("modules/clean/react/growth/trials/components/modals/cancel_trial_survey_loader",["require","exports","tslib","react","modules/clean/react/async/loadable"],(function(e,t,a,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n);var o=s.Loadable({loader:function(){return new Promise((function(t,a){e(["modules/clean/react/growth/trials/components/modals/cancel_trial_survey"],t,a)})).then(a.__importStar).then((function(e){return e.CancelTrialSurveyModal}))}});t.showCancelTrialSurveyModal=function(t,s,r){return new Promise((function(t,a){e(["modules/clean/react/modal"],t,a)})).then(a.__importStar).then((function(e){e.Modal.showInstance(n.default.createElement(o,a.__assign({firstName:t,userId:s},r)))}))}})),define("modules/clean/react/survey/components/dropdown_survey",["require","exports","tslib","classnames","react","spectrum/dropdown_menu","external/lodash","modules/clean/react/css","modules/core/i18n","modules/clean/react/survey/components/survey_tip_card"],(function(e,t,a,n,s,o,r,l,i,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),s=a.__importDefault(s),r=a.__importStar(r);var u=(function(e){function t(t){var n=e.call(this,t)||this;if(n.props.shuffle?(n.surveyOptions=a.__spreadArrays(r.shuffle(n.props.options)),n.props.onShuffle&&n.props.onShuffle(n.surveyOptions)):n.surveyOptions=a.__spreadArrays(n.props.options),n.props.includeOtherOption){var s={reason:i.intl.formatMessage({id:"bmpvII",defaultMessage:"Other"}),value:"other"};n.surveyOptions=a.__spreadArrays(n.surveyOptions,[s])}return n}return a.__extends(t,e),Object.defineProperty(t.prototype,"selectedOptionObject",{get:function(){var e=this;return this.surveyOptions.filter((function(t){return e.props.selectedOption===t.value}))[0]},enumerable:!0,configurable:!0}),t.prototype.renderTipCard=function(){var e=this.selectedOptionObject,t=e&&Boolean(e.tip);return e&&t&&this.props.showTip?s.default.createElement(c.SurveyTipCard,{beforeRedirect:this.props.beforeRedirect,tip:e.tip}):null},t.prototype.renderMenuItems=function(){var e=this;return this.surveyOptions.map((function(t){return s.default.createElement(o.MenuItem,{key:t.value+"-option",selected:t.value===e.props.selectedOption,value:t.value},t.reason)}))},t.prototype.render=function(){var e=this.props.placeholderText;this.props.selectedOption&&(e=this.selectedOptionObject.reason||e);var t=n.default("dropdown-survey__button",{"dropdown-survey__button--invalid":this.props.showError});return s.default.createElement("div",{className:"dropdown-survey"},s.default.createElement(o.DropdownMenu,{onSelection:this.props.onSelection},s.default.createElement(o.DropdownMenuButton,{className:t,fullWidth:this.props.fullWidth},e),s.default.createElement(o.Menu,null,this.renderMenuItems())),this.renderTipCard())},t.defaultProps={includeOtherOption:!0,placeholderText:i.intl.formatMessage({id:"sSIFlq",defaultMessage:"Please select an answer"}),shuffle:!1,showError:!1,showTip:!1},t})(s.default.Component);t.DropdownSurvey=l.requireCssWithComponent(u,["/static/css/react/survey/components/dropdown_survey-vflpiRBo7.css"])})),define("modules/clean/react/survey/components/radio_survey",["require","exports","tslib","classnames","react","spectrum/input","external/lodash","modules/clean/react/css","modules/core/i18n","modules/clean/react/survey/components/survey_tip_card","modules/clean/react/survey/components/radio_survey_option"],(function(e,t,a,n,s,o,r,l,i,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),s=a.__importDefault(s),r=a.__importStar(r);var d=(function(e){function t(t){var l=e.call(this,t)||this;return l.radioGroupName="radioSurvey",l.handleReasonChange=function(e){var t=e.target.value;l.props.onReasonChange(t)},l.renderOtherOption=function(){if(!l.props.includeOtherOption)return null;var e={reason:i.intl.formatMessage({id:"n071Q5",defaultMessage:"Other"}),value:"other"},t=s.default.createElement("span",null,i.intl.formatMessage({id:"01NlbA",defaultMessage:"(please fill in reason below)"}));l.props.showError&&(t=s.default.createElement("span",{className:"radio-survey__other-error"},i.intl.formatMessage({id:"XsWhMa",defaultMessage:"Please enter a reason"})));var a=s.default.createElement("div",{className:"radio-survey__label-text"},e.reason," ",t),n="other"!==l.props.selectedOption;return s.default.createElement(u.RadioSurveyOption,{className:"radio-survey__option radio-survey__option--other-option",key:e.value+"-option",labelText:a,name:l.radioGroupName,onOptionClick:l.props.onOptionChange,selected:e.value===l.props.selectedOption,value:e.value},s.default.createElement(o.Input,{className:"radio-survey__reason-input",disabled:n,onChange:l.handleReasonChange,placeholder:l.props.otherInputPlaceholder}))},l.renderRadioSurveyOptions=function(){return l.surveyOptions.map((function(e){var t=n.default("radio-survey__option",{"radio-survey__option--has-tip":Boolean(e.tip)});return s.default.createElement(u.RadioSurveyOption,{className:t,key:e.value+"-option",labelText:e.reason,name:l.radioGroupName,onOptionClick:l.props.onOptionChange,selected:e.value===l.props.selectedOption,value:e.value},l.renderTipCard(e))}))},l.props.shuffle?(l.surveyOptions=a.__spreadArrays(r.shuffle(l.props.options)),l.props.onShuffle&&l.props.onShuffle(l.surveyOptions)):l.surveyOptions=a.__spreadArrays(l.props.options),l}return a.__extends(t,e),t.prototype.renderTipCard=function(e){var t=this.props.selectedOption===e.value,a=Boolean(e.tip);return t&&a&&this.props.showTip?s.default.createElement(c.SurveyTipCard,{tip:e.tip,beforeRedirect:this.props.beforeRedirect,className:"radio-survey__tip-card"}):null},t.prototype.render=function(){var e=this.props.className,t=n.default("radio-survey",e);return s.default.createElement("div",{className:t},this.renderRadioSurveyOptions(),this.renderOtherOption())},t.defaultProps={includeOtherOption:!0,otherInputPlaceholder:i.intl.formatMessage({id:"Fv7AjG",defaultMessage:"Enter your reason here..."}),shuffle:!1,showTip:!1},t})(s.default.Component);t.RadioSurvey=l.requireCssWithComponent(d,["/static/css/react/survey/components/radio_survey-vflIJfSjK.css"])})),define("modules/clean/react/survey/components/radio_survey_option",["require","exports","tslib","classnames","react","modules/clean/react/css","modules/clean/react/arbor/aspen/elements/arbor_inputs"],(function(e,t,a,n,s,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n);var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.elementClass="radio-survey-option",t.handleOptionClick=function(e){t.props.onOptionClick(t.props.value)},t.renderRadio=function(){return s.default.createElement("div",{className:t.elementClass+"__radio-container"},s.default.createElement(r.ArborRadioInput,{checked:t.props.selected,className:t.elementClass+"__radio-input",name:t.props.name,onChange:t.handleOptionClick,onClick:t.handleOptionClick,required:t.props.required,value:t.props.value}),s.default.createElement("div",{className:t.elementClass+"__radio-label-container"},s.default.createElement("label",{className:t.elementClass+"__radio-label",htmlFor:t.props.value},t.props.labelText)))},t}return a.__extends(t,e),t.prototype.render=function(){var e=n.default(this.elementClass,this.props.className);return s.default.createElement("div",{className:e,onClick:this.handleOptionClick},this.renderRadio(),this.props.children&&s.default.createElement("div",{className:this.elementClass+"__children-container"},this.props.children))},t})((s=a.__importDefault(s)).default.Component);t.RadioSurveyOptionElement=l,t.RadioSurveyOption=o.requireCssWithComponent(l,["/static/css/react/survey/components/radio_survey_option-vflb4z3p1.css"])})),define("modules/clean/react/survey/components/survey_tip_card",["require","exports","tslib","classnames","react","spectrum/tertiary_link","spectrum/tip_card","modules/clean/react/css","modules/core/browser"],(function(e,t,a,n,s,o,r,l,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),s=a.__importDefault(s),i=a.__importStar(i);var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCTAClick=function(e){return function(){t.props.beforeRedirect?t.props.beforeRedirect((function(){i.redirect(e)})):i.redirect(e)}},t}return a.__extends(t,e),t.prototype.renderCTA=function(){var e=this.props.tip.cta;if(!e)return null;var t=e.link,a=e.text;return s.default.createElement(o.TertiaryLink,{className:"survey-tip-card__cta",onClick:this.onCTAClick(t)},a)},t.prototype.render=function(){var e=this.props.tip,t=e.body,a=e.title,o=n.default("survey-tip-card",this.props.className);return s.default.createElement(r.TipCard,{className:o},s.default.createElement("h4",{className:"survey-tip-card__title"},a),s.default.createElement("p",{className:"survey-tip-card__body"},t," ",this.renderCTA()))},t})(s.default.Component);t.SurveyTipCard=l.requireCssWithComponent(c,["/static/css/react/survey/components/survey_tip_card-vfliwE4qa.css"])})),define("modules/clean/react/teams/offboarding/cancel_confirmation/after_cancellation_list",["require","exports","tslib","classnames","react","modules/clean/react/css"],(function(e,t,a,n,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n);var r=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=n.default(this.props.className,"after-cancellation-list");return s.default.createElement("div",{className:e},this.props.children)},t})((s=a.__importDefault(s)).default.Component);t.AfterCancellationList=o.requireCssWithComponent(r,["/static/css/teams/offboarding/cancel_confirmation/after_cancellation_list/after_cancellation_list-vfl2-0S2k.css"])})),define("modules/clean/react/teams/offboarding/cancel_confirmation/after_cancellation_list_item",["require","exports","tslib","react","classnames","modules/clean/static_urls","modules/core/i18n"],(function(e,t,a,n,s,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),s=a.__importDefault(s);var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.renderText=function(){var e=this.props,t=e.content,a=e.boldContent,l=e.iconUrl;if(!t&&!a)return null;var i=void 0,c={b:{fontWeight:500,color:"black"}};t&&a&&(i=n.default.createElement("div",{className:"after-cancellation-list-item__content"},r.intl.formatMessage({id:"VPG1ir",defaultMessage:"<b>{first}</b> {second}"},{first:a,second:t,b:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.default.createElement("b",{style:c.b},e)}})));var u=void 0;l&&(u=n.default.createElement("div",{className:"after-cancellation-list-item__icon_wrapper"},n.default.createElement("img",{src:o.static_url(l),className:"after-cancellation-list-item__icon plan-icon",alt:"Icons showing what features the users will miss"})));var d=s.default("after-cancellation-list-item__col1",this.props.textClassName);return n.default.createElement("div",{className:d},u,i)},t.prototype.render=function(){var e,t=this.props.className?this.props.className:"",a=s.default(((e={"after-cancellation-list-item":!0})[t]=!0,e));return n.default.createElement("li",{className:a},this.renderText(),this.props.children)},t})(n.default.Component);t.AfterCancellationListItem=l})),define("modules/clean/react/teams/offboarding/cancel_confirmation/cancel_confirmation_modal",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/teams/offboarding/cancel_confirmation/after_cancellation_list","modules/clean/react/teams/offboarding/cancel_confirmation/after_cancellation_list_item","modules/clean/ajax","modules/core/browser","modules/core/browser","modules/core/uri","modules/clean/analytics"],(function(e,t,a,n,s,o,r,l,i,c,u,d,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),c=a.__importStar(c),u=a.__importStar(u),d=a.__importStar(d);var f=(function(e){function t(t){var a=e.call(this,t)||this;return a.onPrimaryAction=function(){if(m.TeamsWebActionsLogger.log("team_cancel_modal_confirm"),a.props.isEligibleForCancellationRefund){var e=p.URI.parse("/team/cancel/refund");e.setQuery({state:a.props.csrfToken}),u.redirect(e)}else c.WebRequest({url:"/team/cancel/delete_team",type:"POST",success:function(e){var t=new p.URI({path:"/team/cancel/done",query:JSON.parse(e)}).toString();m.TeamsWebActionsLogger.log("admin_offboarding_cancel_subscription",{step:"info",page:"/cancel"},(function(){return u.redirect(t)}))}})},a.onSecondaryAction=function(){m.TeamsWebActionsLogger.log("team_cancel_modal_downgrade"),d.redirect("/team/admin/billing/manage?show_switch_plan")},a.onTertiaryAction=function(){m.TeamsWebActionsLogger.log("team_cancel_modal_help"),d.redirect("/team/admin/help")},a.onAbandonAction=function(){m.TeamsWebActionsLogger.log("team_cancel_modal_abandon")},a.state={isOpen:!0},a}return a.__extends(t,e),t.showInstance=function(e){r.Modal.showInstance(n.default.createElement(t.ShowCancelConfirmationModal,a.__assign({},e)))},t.prototype.renderButtons=function(){var e=n.default.createElement("div",{className:"dbmodal-button-container"},n.default.createElement("h3",{className:"dbmodal-button-headline"},s.intl.formatMessage({id:"03hVGB",defaultMessage:"Cancel your plan"})),n.default.createElement(r.ModalButton,{className:"confirmation-button",id:"confirmation-button",importance:"primary",onClick:this.onPrimaryAction},s.intl.formatMessage({id:"wmgkFM",defaultMessage:"Confirm cancel"}))),t=n.default.createElement("div",{className:"dbmodal-button-container"},n.default.createElement("h3",{className:"dbmodal-button-headline"},s.intl.formatMessage({id:"qOTKGg",defaultMessage:"Get help with Dropbox"})),n.default.createElement(r.ModalButton,{className:"support-button",id:"support-button",importance:"tertiary",onClick:this.onTertiaryAction},s.intl.formatMessage({id:"K2WP/Z",defaultMessage:"Contact support"}))),a=n.default.createElement("div",{className:"dbmodal-button-container"},n.default.createElement("h3",{className:"dbmodal-button-headline"},s.intl.formatMessage({id:"v2+sDJ",defaultMessage:"Use a lower cost plan"})),n.default.createElement(r.ModalButton,{className:"downgrade-button",id:"downgrade-button",importance:"tertiary",onClick:this.onSecondaryAction},s.intl.formatMessage({id:"Fnezvh",defaultMessage:"Try Business Standard"})));return this.props.subStatus.finalSubState.plan.isStandardPlan?n.default.createElement(r.ModalButtons,null,e,t):n.default.createElement(r.ModalButtons,null,e,a,t)},t.prototype.renderAfterCancellationList=function(){var e,t=this.props.subStatus.finalSubState.plan,a=t.content&&t.content.spaceShortFormTb(),o=s.intl.formatMessage({id:"sReXe5",defaultMessage:"You will lose access to {plan} features."},{plan:this.props.subStatus.finalSubState.plan.content.dropboxDisplayName()}),r=s.intl.formatMessage({id:"pShJIB",defaultMessage:"Your team’s individual accounts will be downgraded."}),c=s.intl.formatMessage({id:"iU7uIU",defaultMessage:"Team member files not shared in the team space will move to individual accounts."});e=a?s.intl.formatMessage({id:"sUIOIx",defaultMessage:"That includes {capacity}, version history, file deletion recovery, remote device wipe, activity reports, and priority support."},{capacity:a}):s.intl.formatMessage({id:"ea1Xq+",defaultMessage:"That includes all the space you need, version history, file deletion recovery, remote device wipe, activity reports, and priority support."});var u=s.intl.formatMessage({id:"LQqHvQ",defaultMessage:"They may not be able to sync files across devices, upload new files or restore old versions of files."}),d=s.intl.formatMessage({id:"EWSp0u",defaultMessage:"These files will no longer be in your control."});return n.default.createElement(l.AfterCancellationList,null,n.default.createElement(i.AfterCancellationListItem,{className:"after-cancellation-list-item business_cancel",iconUrl:"/static/images/revamp_team_cancel/business_2x-vflqK4sTI.png",boldContent:o,content:e}),n.default.createElement(i.AfterCancellationListItem,{className:"after-cancellation-list-item no_access",iconUrl:"/static/images/revamp_team_cancel/no_access_2x-vflbJFsst.png",boldContent:r,content:u}),n.default.createElement(i.AfterCancellationListItem,{className:"after-cancellation-list-item no_access",iconUrl:"/static/images/revamp_team_cancel/team_folder_2x-vfl8CP7bm.png",boldContent:c,content:d}))},t.prototype.render=function(){var e=this.renderAfterCancellationList(),t=this.renderButtons(),a=n.default.createElement("div",{className:"cancel-confirmation-modal-text"},n.default.createElement("div",{className:"cancel-confirmation-modal-text__title"},s.intl.formatMessage({id:"CrL3/u",defaultMessage:"Here’s what will happen if you cancel today"}))),o=n.default.createElement("div",{className:"cancel-confirmation-modal-text"},n.default.createElement("div",{className:"cancel-confirmation-modal-text__info"},s.intl.formatMessage({id:"Y3lFme",defaultMessage:"Your plan will remain active until the end of your billing cycle on {date}. Your plan will no longer renew and you will no longer be charged."},{date:this.props.subStatus.formattedNextBillingDate}))),l=n.default.createElement("div",{className:"cancel-confirmation-modal-text"},s.intl.formatMessage({id:"s2WOQR",defaultMessage:"After {date} the following will happen:"},{date:this.props.subStatus.formattedNextBillingDate}));return n.default.createElement(r.Modal,{className:"cancel-confirmation-modal",id:"cancel-confirmation-modal",buttonComponent:t,showX:!0,clickOutToClose:!0,style:"cancel-confirmation",autoClose:!0,onDismissCompleted:this.onAbandonAction},a,o,l,e)},t.ShowCancelConfirmationModal=o.requireCssWithComponent(t,["/static/css/teams/offboarding/cancel_confirmation/cancel_confirmation_modal-vflRCSxTf.css"]),t})(n.default.Component);t.ShowCancelConfirmationModalView=f})),define("modules/clean/react/teams/offboarding/cancel_reason/cancel_reason_component",["require","exports","tslib","react","external/lodash","modules/clean/analytics","modules/clean/stormcrow/experiment","modules/core/browser","modules/clean/react/teams/offboarding/cancel_confirmation/cancel_confirmation_modal"],(function(e,t,a,n,s,o,r,l,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),s=a.__importStar(s),l=a.__importStar(l);var c=(function(e){function t(t){var n=e.call(this,t)||this;return n.onPrimaryActionCancelModal=function(){o.TeamsWebActionsLogger.log("team_cancel_modal_open"),i.ShowCancelConfirmationModalView.showInstance({subStatus:n.props.subStatus,isEligibleForCancellationRefund:n.props.isEligibleForCancellationRefund,csrfToken:n.props.csrfToken})},n.onSkipLinkCancelModal=function(){o.TeamsWebActionsLogger.log("team_cancel_modal_open"),o.TeamsWebActionsLogger.log("team_cancel_reason_skip",n.sharedLogExtras,(function(){i.ShowCancelConfirmationModalView.showInstance({subStatus:n.props.subStatus,isEligibleForCancellationRefund:n.props.isEligibleForCancellationRefund,csrfToken:n.props.csrfToken})}))},n.redirectToCancel=function(){l.redirect("/team/cancel")},n.onPrimaryAction=function(e){void 0===e&&(e=n.redirectToCancel);var t=Boolean(n.state.selectedOption),s="other"===n.state.selectedOption&&!n.state.reason;if(!t||n.isReasonRequired&&s)return n.setState({showError:!0});var r=n.state.selectedOption;n.isReasonRequired&&"other"===n.state.selectedOption&&(r=n.state.reason);var l=a.__assign(a.__assign({},n.sharedLogExtras),{cancel_reason:r});o.TeamsWebActionsLogger.log("team_cancel_reason_submit",l,e)},n._onSecondaryAction=function(e){void 0===e&&(e=s.noop),o.TeamsWebActionsLogger.log("team_cancel_reason_abandon",n.sharedLogExtras,e)},n.onSkipLink=function(e){void 0===e&&(e=n.redirectToCancel),o.TeamsWebActionsLogger.log("team_cancel_reason_skip",n.sharedLogExtras,e)},n.beforeRedirect=function(e){o.TeamsWebActionsLogger.log("team_cancl_reason_mlm_cta_click",n.sharedLogExtras,e)},n.isValidOptionChange=function(e){return n._isValidOptionChange(e)},n._isValidOptionChange=function(e){return!(n.state.hasOptionChanged&&"other"===e&&n.state.hasReasonChanged&&!n.state.reason)},n.isValidCancelReason=function(e){return n._isValidCancelReason(e)},n._isValidCancelReason=function(e){return!(n.isReasonRequired&&"other"===e&&!n.state.reason)},n.handleOptionChange=function(e){n.setState({hasOptionChanged:!0,selectedOption:e,showError:!n.isValidOptionChange(e),disableContinue:!n.isValidCancelReason(e)})},n.handleReasonChange=function(e){var t=n.state.hasReasonChanged&&n.isReasonRequired&&!e,a=n.state.hasReasonChanged&&n.isReasonRequired&&!e;n.setState({hasReasonChanged:!0,reason:e,showError:t,disableContinue:a})},n.state={hasOptionChanged:!1,hasReasonChanged:!1,reason:"",showError:!1,disableContinue:n.isReasonRequired},n}return a.__extends(t,e),t.prototype.componentDidMount=function(){o.TeamsWebActionsLogger.log("team_cancel_reason_modal_open",this.sharedLogExtras);var e=a.__assign(a.__assign({},this.sharedLogExtras),{reason_values:this.props.reasons.map((function(e){return e.value}))});o.TeamsWebActionsLogger.log("team_cancel_reason_survey_reason_order",e)},Object.defineProperty(t.prototype,"expSubgrowthBizCancelBudgetDownsellRwls",{get:function(){return r.Experiment(this.props.experiments.expSubgrowthBizCancelBudgetDownsellRwls)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sharedLogExtras",{get:function(){return{path:l.get_uri().getPath()}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReasonRequired",{get:function(){var e=!0;return this.expSubgrowthBizCancelBudgetDownsellRwls.variantIs("V3")&&(e=!1),e},enumerable:!0,configurable:!0}),t})(n.default.Component);t.CancelReasonComponent=c})),define("modules/clean/react/teams/offboarding/cancel_reason/cancel_reason_radio_survey",["require","exports","tslib","react","modules/clean/analytics","modules/core/browser","modules/core/i18n","modules/clean/react/survey/components/radio_survey"],(function(e,t,a,n,s,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),o=a.__importStar(o);var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.componentDidMount=function(){s.TeamsWebActionsLogger.log("team_cancel_reason_survey_options_order",{survey_options_order:this.props.options.map((function(e){return e.value})),path:o.get_uri().getPath()})},t.prototype.render=function(){return n.default.createElement("div",{className:"cancel-reason-radio-survey"},n.default.createElement(l.RadioSurvey,{beforeRedirect:this.props.beforeRedirect,includeOtherOption:this.props.includeOtherOption,onOptionChange:this.props.onOptionChange,onReasonChange:this.props.onReasonChange,options:this.props.options,otherInputPlaceholder:r.intl.formatMessage({id:"JPS3CZ",defaultMessage:"I am cancelling because..."}),selectedOption:this.props.selectedOption,showError:this.props.showError,showTip:this.props.showTip}))},t.defaultProps={includeOtherOption:!0},t})(n.default.Component);t.CancelReasonRadioSurvey=i})),define("modules/clean/react/teams/offboarding/cancel_reason/cancel_reason_survey_modal",["require","exports","tslib","react","spectrum/modal","modules/clean/react/css","modules/core/i18n","modules/clean/react/modal","modules/clean/react/survey/components/dropdown_survey","modules/clean/react/teams/offboarding/cancel_reason/cancel_reason_component","modules/clean/react/teams/offboarding/cancel_reason/cancel_reason_radio_survey"],(function(e,t,a,n,s,o,r,l,i,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n);var d=(function(e){function t(t){var s=e.call(this,t)||this;return s.onSubmitSurvey=function(){Boolean(s.props.postSubmitHandler)?s.onPrimaryAction(s.props.postSubmitHandler):s.onPrimaryAction()},s.onSkipSurvey=function(){Boolean(s.props.postSubmitHandler)?s.onSkipLink(s.props.postSubmitHandler):s.onSkipLink()},s.onSecondaryAction=function(){s._onSecondaryAction((function(){return s.setState({isOpen:!1})}))},s.isValidOptionChange=function(e){return s.expSubgrowthBizCancelBudgetDownsellRwls.variantIs("V3")?Boolean(e):s._isValidOptionChange(e)},s.renderSurvey=function(){var e=n.default.createElement(u.CancelReasonRadioSurvey,{onOptionChange:s.handleOptionChange,onReasonChange:s.handleReasonChange,options:s.props.reasons,selectedOption:s.state.selectedOption,showError:s.state.showError});if(s.expSubgrowthBizCancelBudgetDownsellRwls.variantIs("V3")){e=n.default.createElement(i.DropdownSurvey,{beforeRedirect:s.beforeRedirect,fullWidth:!0,onSelection:s.handleOptionChange,options:s.props.reasons,selectedOption:s.state.selectedOption,showError:s.state.showError,showTip:!0})}return e},s.state=a.__assign(a.__assign({},s.state),{isOpen:!0}),s}return a.__extends(t,e),t.showInstance=function(e){l.Modal.showInstance(n.default.createElement(t.ShowCancelReasonSurveyModal,a.__assign({},e)))},Object.defineProperty(t.prototype,"description",{get:function(){return this.props.expRenewBizRevampTeamCancel?r.intl.formatMessage({id:"3zy2Xr",defaultMessage:"Hi {first_name}! Before you cancel your plan, please select a reason below or write your own response at the bottom. Thank you."},{first_name:this.props.firstName}):r.intl.formatMessage({id:"geYCWu",defaultMessage:"Hey {first_name}, we’re sorry you’re thinking of leaving us. Would you tell us why? We might be able to help!"},{first_name:this.props.firstName})},enumerable:!0,configurable:!0}),t.prototype.renderContent=function(){return this.props.expRenewBizRevampTeamCancel?n.default.createElement("div",{className:"cancel-reason-survey-modal__survey-container"},n.default.createElement("div",{className:"cancel-reason-survey-modal-text"},n.default.createElement("p",{className:"cancel-reason-survey-modal-text__description"},this.description),n.default.createElement("p",{className:"cancel-reason-survey-modal-text__instructions"},r.intl.formatMessage({id:"XqqmnR",defaultMessage:"Please select a reason for cancelling"}))),this.renderSurvey()):n.default.createElement("div",{className:"cancel-reason-survey-modal__survey-container"},n.default.createElement("div",{className:"cancel-reason-survey-modal-text"},n.default.createElement("p",{className:"cancel-reason-survey-modal-text__description"},this.description),n.default.createElement("p",{className:"cancel-reason-survey-modal-text__instructions"},r.intl.formatMessage({id:"MWdLCv",defaultMessage:"Please select one reason for cancelling"}))),this.renderSurvey())},t.prototype.render=function(){if(this.props.expRenewBizRevampTeamCancel){var e=n.default.createElement(l.ModalButtons,null,n.default.createElement(l.ModalButton,{importance:"primary",onClick:this.onSkipLinkCancelModal,className:"button-as-link skip-link",id:"skip-link"},r.intl.formatMessage({id:"knjc/t",defaultMessage:"Skip this step"})),n.default.createElement(l.ModalButton,{importance:"primary",onClick:this.onPrimaryActionCancelModal,disabled:this.state.disableContinue,id:"continue-button"},r.intl.formatMessage({id:"LgJiOW",defaultMessage:"Continue"}))),t=n.default.createElement("div",{className:"cancel-reason-survey-modal-text__title"},r.intl.formatMessage({id:"YWRDBh",defaultMessage:"Let us know why you’re cancelling"}));return n.default.createElement(l.Modal,{className:"cancel-reason-survey-modal",id:"cancel-reason-survey-modal",buttonComponent:e,showX:!0,clickOutToClose:!0,style:"cancel",onDismissCompleted:this.onSecondaryAction},t,this.renderContent())}return n.default.createElement(s.UtilityModal,{ariaLabel:r.intl.formatMessage({id:"LQzEeJ",defaultMessage:"Cancel plan"}),className:"cancel-reason-survey-modal",link:r.intl.formatMessage({id:"PaR0U3",defaultMessage:"Skip"}),onLink:this.onSkipSurvey,onPrimaryAction:this.onSubmitSurvey,onSecondaryAction:this.onSecondaryAction,open:this.state.isOpen,overlayClassName:"cancel-reason-survey-modal--overlay",primaryAction:r.intl.formatMessage({id:"5oJ/ON",defaultMessage:"Continue with cancellation"}),secondaryAction:r.intl.formatMessage({id:"o9iQdR",defaultMessage:"Don’t Cancel"}),title:r.intl.formatMessage({id:"VeFhFg",defaultMessage:"Are you sure you want to cancel?"})},this.renderContent())},t.ShowCancelReasonSurveyModal=o.requireCssWithComponent(t,["/static/css/teams/offboarding/cancel_reason/cancel_reason_survey_modal-vflpJu3n7.css"]),t})(c.CancelReasonComponent);t.ShowCancelReasonSurveyModalView=d})),define("modules/clean/react/growth/scheduled_cancellation_snackbar",["require","exports","tslib","modules/core/browser","react","dig-components/buttons","dig-components/snackbar","modules/clean/react/css","modules/core/i18n","modules/clean/api_v2/user_client","modules/clean/stormcrow/experiment","modules/clean/account_page/constants","modules/clean/account_page/widgets/plan/views/cancel_changes_modal","modules/core/exception","modules/clean/react/user_metadata/api","modules/clean/react/growth/util","modules/clean/payments/skus/constants","modules/clean/bem","modules/clean/analytics","modules/clean/stormcrow/stormcrow_exposure_logger","external/lodash"],(function(e,t,a,n,s,o,r,l,i,c,u,d,p,m,f,h,g,_,v,b,y){"use strict";var S;Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importStar(n),s=a.__importStar(s),y=a.__importStar(y),t.cn=_.bem("scheduled-cancellation-snackbar"),(function(e){e.PERSONAL="personal",e.WORK="work",e.INVALID="invalid"})(S=t.UserRole||(t.UserRole={}));var w=function(e){return Math.max.apply(Math,Object.keys(e))},M={0:1,1:7,2:7},C=w(M),E={0:1,1:14,2:16,3:30,4:60},R=w(E);t.ScheduledCancellationSnackbarView=function(){var e=s.useState(!0),l=e[0],c=e[1],f=x(),h=f.cancellationInfo,g=f.cancellationUserMetadata,_=new Date,b=function(e,t){var n={};if(h){var s=h.scheduled_cancellation_date,o=h.schedule_id,r=h.growth_retention_teams_scheduled_cancellation,l=h.growth_retention_personal_scheduled_cancellation;n=a.__assign(a.__assign({},n),{scheduled_cancellation_date:s,schedule_id:o,growth_retention_teams_scheduled_cancellation:r,growth_retention_personal_scheduled_cancellation:l})}g&&(n=a.__assign(a.__assign({},n),g)),v.ProEventsLogger.log(e,a.__assign(a.__assign({},t),n))},y=i.intl.formatMessage({id:"TRTnfU",defaultMessage:"Undo plan change"}),w=function(){v.ProEventsLogger.log("de_modal_cancel_reminder_confirm_undo"),t.setCancellationReminderDismissalInfo(0,0)},M=function(){t.setCancellationReminderDismissalInfo(((null==g?void 0:g.dismissalCount)||0)+1,_.getTime()),c(!1)},C=function(){b("de_modal_cancel_reminder_view",{})},E=function(){b("de_modal_cancel_reminder_dismiss")},R=function(){b("de_snackbar_cancel_reminder_unload")};s.useEffect((function(){if(h&&g&&P(h)){var e=h.growth_retention_personal_scheduled_cancellation,a=h.growth_retention_teams_scheduled_cancellation;O(h)?u.Experiment(e).variantIs("V1")?t.shouldRenderForDate(g,null==h?void 0:h.schedule_id)?(N(g,b),I("growth_retention_personal_scheduled_cancellation",e),window.addEventListener("beforeunload",R)):b("de_snackbar_cancel_reminder_is_not_due_to_view"):t.shouldRenderForDate(g,null==h?void 0:h.schedule_id)?I("growth_retention_personal_scheduled_cancellation",e):b("de_snackbar_cancel_reminder_is_not_due_to_view"):k(h)&&(u.Experiment(a).variantIs("V1")?t.shouldRenderForDate(g,null==h?void 0:h.schedule_id)?(N(g,b),I("growth_retention_teams_scheduled_cancellation",a),window.addEventListener("beforeunload",R)):b("de_snackbar_cancel_reminder_is_not_due_to_view"):t.shouldRenderForDate(g,null==h?void 0:h.schedule_id)?I("growth_retention_teams_scheduled_cancellation",a):b("de_snackbar_cancel_reminder_is_not_due_to_view"))}}),[h,g]),s.useEffect((function(){return function(){window.removeEventListener("beforeunload",R)}}),[]);var T=s.default.createElement("div",{className:t.cn("")},s.default.createElement(r.Snackbar,{open:l,timeout:1e4,onRequestClose:function(){b("de_snackbar_cancel_reminder_dismiss"),M()},className:t.cn("snackbar")},s.default.createElement(r.Snackbar.Message,null,h?i.intl.formatMessage({id:"+Z41bT",defaultMessage:"Your paid plan will end on {date}."},{date:h.scheduled_cancellation_date}):""),s.default.createElement(r.Snackbar.Actions,null,s.default.createElement(o.Button,{className:t.cn("undo-changes"),variant:"transparent",inverse:!0,onClick:function(){b("de_snackbar_cancel_reminder_click");var e=(null==h?void 0:h.user_role)||S.INVALID;e===S.PERSONAL?(p.CancelChangesModalConfirmationView.showInstance({transitionPerformed:w,onClose:E,cancellationType:d.CancellationType.IND_SUBSCRIPTION,reOpenModalDialogAfterCancellation:!1,onRedesignedModalOpen:C,shouldShowRedesignedModal:!0}),M()):e===S.WORK?(w(),n.redirect("/team/cancel-downgrade")):(m.reportException({err:new Error("User has invalid role for scheduled_cancellation_snackbar."),severity:m.SEVERITY.CRITICAL}),n.redirect("/account/plan?modal=plan"))}},y))));if(h&&g&&P(h)){var A=h.growth_retention_personal_scheduled_cancellation,D=h.growth_retention_teams_scheduled_cancellation;if(O(h)){if(u.Experiment(A).variantIs("V1")&&t.shouldRenderForDate(g,null==h?void 0:h.schedule_id))return T}else if(k(h)&&u.Experiment(D).variantIs("V1")&&t.shouldRenderForDate(g,null==h?void 0:h.schedule_id))return T}return s.default.createElement("noscript",null)},t.setCancellationReminderDismissalInfo=function(e,t){var a=h.getActiveUserId();if(a)return f.setUserMetadata({SCHEDULED_CANCELLATION_REMINDER_DISMISSED_COUNT:e,SCHEDULED_CANCELLATION_REMINDER_LAST_DISMISSED_DATE:t},a)};var T=function(e,t){return e.setDate(e.getDate()+t),e.getTime()};t.shouldRenderForDate=function(e,a){if(!e||!a)return!1;var n,s=e.dismissalCount||0,o=e.lastDismissedDate||0,r=new Date(o);a===g.ScheduleId.MONTHLY&&s<=C&&M.hasOwnProperty(s)?n=T(r,M[s]):a===g.ScheduleId.YEARLY&&s<=R&&E.hasOwnProperty(s)&&(n=T(r,E[s]));var l=new Date;return!n||s?!!n&&l.getTime()>n:(t.setCancellationReminderDismissalInfo(1,n),!1)};var x=function(){var e=s.useState(void 0),t=e[0],n=e[1],o=s.useState(void 0),r=o[0],l=o[1];return s.useEffect((function(){var e=h.getActiveUserId();if(e){a.__awaiter(void 0,void 0,Promise,(function(){var t,n;return a.__generator(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,f.getUserMetadata(["SCHEDULED_CANCELLATION_REMINDER_DISMISSED_COUNT","SCHEDULED_CANCELLATION_REMINDER_LAST_DISMISSED_DATE"],e)];case 1:return t=a.sent(),[3,3];case 2:return a.sent(),t={SCHEDULED_CANCELLATION_REMINDER_DISMISSED_COUNT:0,SCHEDULED_CANCELLATION_REMINDER_LAST_DISMISSED_DATE:0},[3,3];case 3:return n={dismissalCount:t.SCHEDULED_CANCELLATION_REMINDER_DISMISSED_COUNT||0,lastDismissedDate:t.SCHEDULED_CANCELLATION_REMINDER_LAST_DISMISSED_DATE||0},l(n),[2,n]}}))})),a.__awaiter(void 0,void 0,Promise,(function(){var t,s;return a.__generator(this,(function(a){switch(a.label){case 0:t=(new c.UserApiV2Client).ns("growth"),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.rpc("get_downgrade_to_basic_info",void 0,{subjectUserId:e})];case 2:return s=a.sent(),[3,4];case 3:return a.sent(),s={scheduled_for_cancellation:!1},[3,4];case 4:return n(s),[2,s]}}))}))}}),[]),{cancellationInfo:t,cancellationUserMetadata:r}},I=y.once((function(e,t){return b.logVariantExposure(e,t)})),N=y.once((function(e,t){var a=new Date,n=new Date(e.lastDismissedDate||0),s=a.getTime()-n.getTime(),o=Math.round(s/864e5);t("de_snackbar_cancel_reminder_view",{impressionCount:e.dismissalCount||0,daysSinceLastDismissal:o})})),P=function(e){if(!e)return!1;var t=e.scheduled_for_cancellation,a=e.scheduled_cancellation_date;return t&&Boolean(a)},O=function(e){return!(!e||!e.user_role)&&e.user_role===S.PERSONAL},k=function(e){if(!e)return!1;var t=e.user_role,a=e.is_locked_team,n=e.is_team_admin;return t===S.WORK&&!a&&Boolean(n)};t.ScheduledCancellationSnackbar=l.requireCssWithComponent(t.ScheduledCancellationSnackbarView,["/static/css/dig-components/index.web-vflZHG-C1.css","/static/css/growth/scheduled_cancellation_snackbar-vflKILjg7.css"])}));
//# sourceMappingURL=pkg-account_subscription.min.js-vflARLfFe.map